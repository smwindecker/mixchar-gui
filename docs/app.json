[{"name":"server.R","content":"# ============================================================================\n# server.R - Shiny Server Logic for mixchar GUI\n# ============================================================================\n#\n# Purpose:\n#   This file contains the server-side logic for the mixchar Shiny workbench.\n#   It handles data processing, deconvolution, visualization, and carbon\n#   fraction calculations for thermogravimetric analysis.\n#\n# Architecture:\n#   - Uses reactiveValues (rv) to manage application state\n#   - Workflow: Load data -> Process -> Deconvolve -> Visualize -> Fractions\n#   - Each step depends on previous step's outputs stored in rv\n#\n# Key Components:\n#   - rv$raw: Raw uploaded/example data\n#   - rv$processed: Processed data from mixchar::process()\n#   - rv$decon: Deconvolution results from mixchar::deconvolve()\n#   - rv$source: Tracks data source (\"upload\" or \"example\")\n#\n# Dependencies:\n#   - mixchar package (fixed-carbon branch required)\n#   - shiny, DT, plotly packages\n#   - sankey.R for Sankey diagram rendering\n#\n# Modification Notes:\n#   - When adding new workflow steps, update rv reactiveValues accordingly\n#   - UI inputs are accessed via input$<id>, outputs via output$<id>\n#   - Use req() to ensure dependencies before rendering outputs\n#   - Use observeEvent() for user-triggered actions\n#\n# ============================================================================\n\nlibrary(shiny)\nlibrary(mixchar)\nlibrary(DT)\nlibrary(plotly)\nsource(\"sankey.R\")\n\n# Require the fixed-carbon branch of mixchar so carbon-fraction helpers are present.\n# This check ensures the required functions exist before the app runs.\nif (!exists(\"calculate_fixed_carbon_fractions\", where = asNamespace(\"mixchar\"), inherits = FALSE)) {\n  stop(\n    \"mixchar fixed-carbon branch required. Install via remotes::install_github('smwindecker/mixchar@v0.1.1-dev').\"\n  )\n}\n\n# ----------------------------------------------------------------------------\n# Helper Functions\n# ----------------------------------------------------------------------------\n\n#' Parse probability values from text input\n#'\n#' Converts a comma/semicolon/whitespace-separated string of probabilities\n#' into a numeric vector. Used for quantile band probabilities in deconvolution plots.\n#'\n#' @param txt Character string containing probability values (e.g., \"0.025, 0.5, 0.975\")\n#' @return Numeric vector of probabilities. Defaults to c(0.025, 0.5, 0.975) if parsing fails.\nparse_probs <- function(txt) {\n  vals <- suppressWarnings(as.numeric(unlist(strsplit(txt, \"[,;\\\\s]+\"))))\n  vals <- vals[!is.na(vals)]\n  if (length(vals) == 0) c(0.025, 0.5, 0.975) else vals\n}\n\n# Default parameter values for the beech example dataset.\n# These are automatically populated when user clicks \"Use example data\".\nexample_defaults <- list(\n  skip_rows = 40,\n  init_mass = 10.64,\n  pyro_start = 127,\n  pyro_end = 191.5,\n  temp_units = \"C\"\n)\n\n#' Guess column name from candidates\n#'\n#' Attempts to match a column name in the dataframe to one of the candidate names\n#' (case-insensitive). Used for auto-selecting temperature, mass, time columns\n#' when loading example data.\n#'\n#' @param df Data frame to search\n#' @param candidates Character vector of candidate column names to match\n#' @return First matching column name, or first column in df if no match\nguess_col <- function(df, candidates) {\n  nms <- names(df)\n  hit <- nms[tolower(nms) %in% tolower(candidates)]\n  if (length(hit) > 0) return(hit[1])\n  nms[1]\n}\n\n# ============================================================================\n# Shiny Server Function\n# ============================================================================\n\nserver <- function(input, output, session) {\n  # --------------------------------------------------------------------------\n  # Application State Management\n  # --------------------------------------------------------------------------\n  # Reactive values store the application state across user interactions.\n  # These values are shared across all observers and reactive expressions.\n  #\n  # rv$raw: Raw data from CSV upload or example file\n  # rv$processed: Processed data object from mixchar::process()\n  # rv$decon: Deconvolution results from mixchar::deconvolve()\n  # rv$file_reset: Counter to invalidate fileInput when reset needed\n  # rv$source: Data source identifier (\"upload\", \"example\", or \"none\")\n  # rv$example_path: Path to example data file if using example\n  # --------------------------------------------------------------------------\n  rv <- reactiveValues(\n    raw = NULL,\n    processed = NULL,\n    decon = NULL,\n    file_reset = 0,\n    source = \"none\",\n    example_path = NULL\n  )\n  \n  # --------------------------------------------------------------------------\n  # Data Selection Helper Functions\n  # --------------------------------------------------------------------------\n  \n  #' Get data configuration for temperature program plot\n  #'\n  #' Determines which dataset and columns to use for the temperature program plot.\n  #' Prefers original stage-coded raw data (e.g., beech has 6 stages) over processed\n  #' data, as it preserves more detailed stage information for visualization.\n  #'\n  #' @return List with data, time_col, temp_col, and stage_col\n  temp_program_data <- function() {\n    if (!is.null(rv$raw)) {\n      stage_col <- if (!is.null(input$stage_col) && nzchar(input$stage_col) &&\n                       input$stage_col %in% names(rv$raw)) {\n        input$stage_col\n      } else if (\"stage\" %in% names(rv$raw)) {\n        \"stage\"\n      } else {\n        NULL\n      }\n      \n      if (!is.null(stage_col)) {\n        # Use raw data with user-selected or auto-detected stage column\n        return(list(\n          data = rv$raw,\n          time_col = input$time_col,\n          temp_col = input$temp_col,\n          stage_col = stage_col\n        ))\n      }\n    }\n    \n    # Fallback to processed data if no stage column available in raw data\n    list(\n      data = rv$processed$all_data,\n      time_col = \"time\",\n      temp_col = \"temp_C\",\n      stage_col = \"stage\"\n    )\n  }\n  \n  # --------------------------------------------------------------------------\n  # UI Input Management Functions\n  # --------------------------------------------------------------------------\n  \n  # Dynamic file input that resets when rv$file_reset changes.\n  # This allows programmatic clearing of uploaded files.\n  output$datafile_ui <- renderUI({\n    rv$file_reset  # invalidate when reset is requested\n    fileInput(\"datafile\", \"Upload CSV\", accept = c(\".csv\"))\n  })\n  \n  #' Reset all column selection inputs to empty\n  #'\n  #' Clears the column selection dropdowns when new data is loaded.\n  #' Called when user uploads a new file or resets the application.\n  reset_column_inputs <- function() {\n    updateSelectInput(session, \"temp_col\", choices = c(\"Select column\" = \"\"), selected = \"\")\n    updateSelectInput(session, \"mass_col\", choices = c(\"Select column\" = \"\"), selected = \"\")\n    updateSelectInput(session, \"time_col\", choices = c(\"Select column\" = \"\"), selected = \"\")\n    updateSelectInput(session, \"stage_col\", choices = c(\"Select column\" = \"\"), selected = \"\")\n  }\n  \n  #' Update column selection inputs with dataframe column names\n  #'\n  #' Populates the column selection dropdowns with available columns from the\n  #' loaded dataframe. Optionally pre-selects columns if provided.\n  #'\n  #' @param df Data frame whose column names will populate the dropdowns\n  #' @param selected Named list with optional pre-selected columns (temp, mass, time, stage)\n  set_column_inputs <- function(df, selected = list(temp = \"\", mass = \"\", \n                                                    time = \"\", stage = \"\")) {\n    choices <- c(\"Select column\" = \"\", names(df))\n    updateSelectInput(\n      session, \"temp_col\",\n      choices = choices,\n      selected = if (is.null(selected$temp)) \"\" else selected$temp\n    )\n    updateSelectInput(\n      session, \"mass_col\",\n      choices = choices,\n      selected = if (is.null(selected$mass)) \"\" else selected$mass\n    )\n    updateSelectInput(\n      session, \"time_col\",\n      choices = choices,\n      selected = if (is.null(selected$time)) \"\" else selected$time\n    )\n    updateSelectInput(\n      session, \"stage_col\",\n      choices = choices,\n      selected = if (is.null(selected$stage)) \"\" else selected$stage\n    )\n  }\n  \n  #' Reset processing parameter inputs to defaults\n  #'\n  #' Clears processing inputs (mass, pyrolysis times) when new data is loaded.\n  #' Temperature units are reset to example defaults.\n  reset_processing_inputs <- function() {\n    updateNumericInput(session, \"init_mass\", value = NA_real_)\n    updateNumericInput(session, \"pyro_start\", value = NA_real_)\n    updateNumericInput(session, \"pyro_end\", value = NA_real_)\n    updateSelectInput(session, \"temp_units\", selected = example_defaults$temp_units)\n  }\n\n  # --------------------------------------------------------------------------\n  # Reproducible Script Generation\n  # --------------------------------------------------------------------------\n  \n  #' Build reproducible R script from current app state\n  #'\n  #' Generates a complete R script that reproduces the current analysis workflow.\n  #' The script includes data loading, processing, deconvolution, plotting, and\n  #' (if applicable) carbon fraction calculations.\n  #'\n  #' @return Character vector of R code lines\n  #' @note Requires rv$processed to be set. Script includes all parameters\n  #'       currently configured in the app (columns, processing params, etc.)\n  build_repro_script <- function() {\n    req(rv$processed)\n\n    fmt_bool <- function(x) if (isTRUE(x)) \"TRUE\" else \"FALSE\"\n    skip_val <- if (is.na(input$skip_rows)) 0 else input$skip_rows\n    data_path <- if (identical(rv$source, \"upload\") && !is.null(input$datafile$name)) {\n      input$datafile$name\n    } else if (identical(rv$source, \"example\") && !is.null(rv$example_path)) {\n      basename(rv$example_path)\n    } else {\n      \"path/to/your-data.csv\"\n    }\n    stage_arg <- if (!is.null(input$stage_col) && nzchar(input$stage_col)) {\n      shQuote(input$stage_col)\n    } else {\n      \"NULL\"\n    }\n    colour_segments <- fmt_bool(!isTRUE(input$colour_segments))\n\n    script <- c(\n      \"# R script exported from the mixchar Shiny workbench\",\n      \"library(mixchar)\",\n      \"\",\n      sprintf(\"data_path <- %s  # adjust to your own file path\", shQuote(data_path)),\n      sprintf(\"raw <- read.csv(data_path, skip = %s, check.names = FALSE)\", skip_val),\n      \"\",\n      \"# Process data with the parameters used in the app\",\n      \"processed <- process(\",\n      sprintf(\"  data = raw,\"),\n      sprintf(\"  init_mass = %s,\", input$init_mass),\n      sprintf(\"  temp = %s,\", shQuote(input$temp_col)),\n      sprintf(\"  mass_loss = %s,\", shQuote(input$mass_col)),\n      sprintf(\"  time = %s,\", shQuote(input$time_col)),\n      sprintf(\"  pyrolysis_start_time = %s,\", input$pyro_start),\n      sprintf(\"  pyrolysis_end_time = %s,\", input$pyro_end),\n      sprintf(\"  temp_units = %s\", shQuote(input$temp_units)),\n      \")\",\n      \"\",\n      \"# Summaries and plots\",\n      \"stage_summary(processed)\",\n      \"png('processed_plot_mass.png', width = 1200, height = 1200, res = 150)\",\n      sprintf(\"plot(processed, plot_type = 'mass', colour_segments = %s)\", colour_segments),\n      \"dev.off()\",\n      \"\",\n      \"png('temp_program_plot.png', width = 1200, height = 1200, res = 150)\",\n      sprintf(\"plot_temp_program(raw, time_col = %s, temp_col = %s, stage_col = %s)\",\n              shQuote(input$time_col), shQuote(input$temp_col), stage_arg),\n      \"dev.off()\"\n    )\n\n    # Add deconvolution section if deconvolution has been run\n    if (!is.null(rv$decon)) {\n      n_peaks_val <- if (is.null(rv$decon$n_peaks)) \"NULL\" else rv$decon$n_peaks\n      probs <- parse_probs(input$band_probs)\n      prob_line <- paste(format(probs, trim = TRUE), collapse = \", \")\n\n      decon_lines <- c(\n        \"\",\n        \"# Deconvolution\",\n        sprintf(\"decon <- deconvolve(processed, seed = %s, n_peaks = %s)\", input$decon_seed, n_peaks_val),\n        \"weights <- decon$weights\",\n        \"write.csv(weights, 'decon_weights.csv', row.names = FALSE)\",\n        \"\",\n        sprintf(\"probs <- c(%s)\", prob_line),\n        \"png('decon_plot.png', width = 1200, height = 1200, res = 150)\",\n        sprintf(\"plot(decon, bw = %s, show_quantile_band = %s, quantile_probs = probs, n_draws = %s, seed = %s)\",\n                fmt_bool(input$decon_bw), fmt_bool(input$show_band), input$band_draws, input$band_seed),\n        \"dev.off()\"\n      )\n\n      # Carbon fractions are only calculated for 3-peak deconvolutions\n      if (!is.null(rv$decon$n_peaks) && rv$decon$n_peaks == 3) {\n        fc_lines <- c(\n          \"\",\n          \"# Carbon fractions (3-peak only)\",\n          \"moisture <- mixchar:::calculate_moisture_content(processed)\",\n          \"ash <- mixchar:::calculate_ash_content(processed)\",\n          sprintf(\"fc <- calculate_fixed_carbon_fractions(decon, dry_basis_fixed_carbon_hemicellulose = %s, dry_basis_fixed_carbon_cellulose = %s, dry_basis_fixed_carbon_lignin = %s)\",\n                  input$fc_hemi, input$fc_cell, input$fc_lig),\n          \"totals <- mixchar:::calculate_total_fractions(decon, fc)\",\n          \"vol_H <- if (!is.null(fc$volatile_HC_fraction)) fc$volatile_HC_fraction else fc$Hvp\",\n          \"vol_C <- if (!is.null(fc$volatile_CL_fraction)) fc$volatile_CL_fraction else fc$Cvp\",\n          \"vol_L <- if (!is.null(fc$volatile_LG_fraction)) fc$volatile_LG_fraction else fc$Lvp\",\n          \"fc_H <- if (!is.null(fc$fixed_carbon_HC_fraction)) fc$fixed_carbon_HC_fraction else fc$Hfp\",\n          \"fc_C <- if (!is.null(fc$fixed_carbon_CL_fraction)) fc$fixed_carbon_CL_fraction else fc$Cfp\",\n          \"fc_L <- if (!is.null(fc$fixed_carbon_LG_fraction)) fc$fixed_carbon_LG_fraction else fc$Lfp\",\n          \"fractions <- data.frame(\",\n          \"  Component = c(\",\n          \"    'Moisture',\",\n          \"    'Hemicellulose volatile', 'Cellulose volatile', 'Lignin volatile',\",\n          \"    'Hemicellulose fixed carbon', 'Cellulose fixed carbon', 'Lignin fixed carbon',\",\n          \"    'Hemicellulose total', 'Cellulose total', 'Lignin total',\",\n          \"    'Ash'\",\n          \"  ),\",\n          \"  Percent = round(c(\",\n          \"    moisture,\",\n          \"    vol_H, vol_C, vol_L,\",\n          \"    fc_H, fc_C, fc_L,\",\n          \"    totals$H_total, totals$C_total, totals$L_total,\",\n          \"    ash\",\n          \"  ), 2)\",\n          \")\",\n          \"write.csv(fractions, 'carbon_fractions.csv', row.names = FALSE)\"\n        )\n        decon_lines <- c(decon_lines, fc_lines)\n      }\n\n      script <- c(script, decon_lines)\n    }\n\n    script\n  }\n  \n  #' Apply example data default parameters\n  #'\n  #' Populates all processing inputs with values appropriate for the beech\n  #' example dataset. Also increments file_reset to clear any uploaded file.\n  apply_example_inputs <- function() {\n    updateNumericInput(session, \"skip_rows\", value = example_defaults$skip_rows)\n    updateNumericInput(session, \"init_mass\", value = example_defaults$init_mass)\n    updateNumericInput(session, \"pyro_start\", value = example_defaults$pyro_start)\n    updateNumericInput(session, \"pyro_end\", value = example_defaults$pyro_end)\n    updateSelectInput(session, \"temp_units\", selected = example_defaults$temp_units)\n    rv$file_reset <- rv$file_reset + 1  # clear any previously uploaded file in the UI\n  }\n  \n  # --------------------------------------------------------------------------\n  # Data Loading Observers\n  # --------------------------------------------------------------------------\n  \n  # Load example data and auto-configure column selections\n  observeEvent(input$use_example, {\n    apply_example_inputs()\n    example_path <- if (file.exists(\"beech_example.csv\")) {\n      \"beech_example.csv\"\n    } else if (file.exists(file.path(\"..\", \"beech_example.csv\"))) {\n      file.path(\"..\", \"beech_example.csv\")\n    } else {\n      stop(\"example data not found; place it in this app folder or its parent.\")\n    }\n    rv$source <- \"example\"\n    rv$example_path <- example_path\n    df <- read.csv(example_path, skip = example_defaults$skip_rows, check.names = FALSE)\n    rv$raw <- df\n    set_column_inputs(df, selected = list(\n      temp = guess_col(df, c(\"temp\", \"temperature\", \"temp_c\")),\n      mass = guess_col(df, c(\"mass_loss\", \"massloss\", \"mass\")),\n      time = guess_col(df, c(\"time\", \"t\", \"minutes\", \"min\")),\n      stage = if (\"stage\" %in% names(df)) \"stage\" else \"\"\n    ))\n    rv$processed <- NULL\n    rv$decon <- NULL\n  })\n  \n  # Handle CSV file upload from user\n  observeEvent(input$datafile, {\n    req(input$datafile)\n    # Reset skip rows to default (0) when user uploads their own file.\n    # This prevents using example skip_rows value with user data.\n    skip_val <- 0\n    updateNumericInput(session, \"skip_rows\", value = skip_val)\n    \n    df <- read.csv(input$datafile$datapath, skip = skip_val, check.names = FALSE)\n    rv$raw <- df\n    rv$processed <- NULL\n    rv$decon <- NULL\n    rv$source <- \"upload\"\n    rv$example_path <- NULL\n    reset_processing_inputs()\n    set_column_inputs(df)\n  })\n  \n  # Reload data with new skip_rows value\n  # This allows users to adjust metadata rows without re-uploading\n  observeEvent(input$apply_skip, {\n    skip_val <- if (is.na(input$skip_rows)) 0 else input$skip_rows\n    \n    # Determine which dataset to reload based on source (upload vs example)\n    data_path <- NULL\n    if (!is.null(input$datafile) && rv$source == \"upload\") {\n      data_path <- input$datafile$datapath\n    } else if (rv$source == \"example\" && !is.null(rv$example_path) && file.exists(rv$example_path)) {\n      data_path <- rv$example_path\n    }\n    \n    if (is.null(data_path)) {\n      showNotification(\"No data to reload. Upload a file or use example data first.\", type = \"error\")\n      return()\n    }\n    \n    df <- read.csv(data_path, skip = skip_val, check.names = FALSE)\n    rv$raw <- df\n    rv$processed <- NULL\n    rv$decon <- NULL\n    set_column_inputs(df, selected = list(\n      temp = input$temp_col,\n      mass = input$mass_col,\n      time = input$time_col,\n      stage = input$stage_col\n    ))\n  })\n  \n  # --------------------------------------------------------------------------\n  # Data Display Outputs\n  # --------------------------------------------------------------------------\n  \n  # Display raw data preview table\n  output$raw_preview <- renderDataTable({\n    req(rv$raw)\n    datatable(\n      rv$raw,\n      options = list(\n        dom = \"t\",\n        scrollX = TRUE,\n        scrollY = \"60vh\",\n        paging = FALSE,\n        searching = FALSE,\n        info = FALSE,\n        orderClasses = TRUE\n      ),\n      class = \"display nowrap\"\n    )\n  })\n  \n  # --------------------------------------------------------------------------\n  # Data Processing\n  # --------------------------------------------------------------------------\n  \n  # Process raw data using mixchar::process()\n  # This is the core data transformation step that identifies pyrolysis stages\n  observeEvent(input$do_process, {\n    req(rv$raw)\n    temp_col <- input$temp_col\n    mass_loss_col <- input$mass_col\n    time_col <- input$time_col\n    temp_units <- input$temp_units\n    \n    # Validate all required inputs are provided\n    validate(\n      need(!is.na(input$init_mass), \"Initial mass is required.\"),\n      need(!is.na(input$pyro_start), \"Pyrolysis start time is required.\"),\n      need(!is.na(input$pyro_end), \"Pyrolysis end time is required.\"),\n      need(temp_col != \"\", \"Select the temperature column.\"),\n      need(mass_loss_col != \"\", \"Select the mass loss column.\"),\n      need(time_col != \"\", \"Select the time column.\"),\n      need(!is.null(temp_units) && nzchar(temp_units), \"Select the temperature units.\"),\n      need(temp_units %in% c(\"C\", \"K\"), \"Temperature units must be C or K.\"),\n      need(input$pyro_end > input$pyro_start, \"Pyrolysis end must be after start.\"),\n      need(all(c(temp_col, mass_loss_col, time_col) %in% names(rv$raw)),\n           \"Data must include temperature, mass loss, and time columns.\")\n    )\n    \n    # Attempt processing with error handling\n    # If processing fails, show notification and reset state\n    proc <- tryCatch({\n      process(\n        data = rv$raw,\n        init_mass = input$init_mass,\n        temp = temp_col,\n        mass_loss = mass_loss_col,\n        time = time_col,\n        pyrolysis_start_time = input$pyro_start,\n        pyrolysis_end_time = input$pyro_end,\n        temp_units = temp_units\n      )\n    }, error = function(e) {\n      rv$processed <- NULL\n      rv$decon <- NULL\n      showNotification(\n        paste(\n          \"Processing failed. Please ensure the temperature units (C/K) match the file and the pyrolysis window is appropriate.\",\n          e$message\n        ),\n        type = \"error\",\n        duration = 10\n      )\n      return(NULL)\n    })\n    \n    if (is.null(proc)) return()\n    rv$processed <- proc\n    rv$decon <- NULL  # Clear deconvolution results when new processing occurs\n  })\n  \n  # --------------------------------------------------------------------------\n  # Processing Results Display\n  # --------------------------------------------------------------------------\n  \n  # Display stage summary table from processed data\n  output$stage_summary_tbl <- renderDataTable({\n    req(rv$processed)\n    df <- mixchar::stage_summary(rv$processed)\n    numeric_cols <- which(vapply(df, is.numeric, logical(1)))\n    dt <- datatable(df, options = list(dom = \"t\"))\n    if (length(numeric_cols)) {\n      dt <- formatRound(dt, columns = numeric_cols, digits = 2)\n    }\n    dt\n  })\n  \n  output$dl_stage_summary <- downloadHandler(\n    filename = function() \"stage_summary.csv\",\n    content = function(file) {\n      req(rv$processed)\n      df <- mixchar::stage_summary(rv$processed)\n      numeric_cols <- which(vapply(df, is.numeric, logical(1)))\n      if (length(numeric_cols)) {\n        df[numeric_cols] <- lapply(df[numeric_cols], round, 2)\n      }\n      write.csv(df, file, row.names = FALSE)\n    }\n  )\n  \n  # Temperature program plot showing stages over time\n  # Uses temp_program_data() to select appropriate data source\n  output$temp_program_plot <- renderPlot({\n    req(rv$processed)\n    cfg <- temp_program_data()\n    plot_temp_program(cfg$data,\n                      time_col = cfg$time_col,\n                      temp_col = cfg$temp_col,\n                      stage_col = cfg$stage_col)\n  }, res = 120)\n  \n  output$dl_temp_program_plot <- downloadHandler(\n    filename = function() \"temp_program_plot.png\",\n    content = function(file) {\n      req(rv$processed)\n      png(file, width = 1200, height = 1200, res = 150)\n      cfg <- temp_program_data()\n      plot_temp_program(cfg$data,\n                        time_col = cfg$time_col,\n                        temp_col = cfg$temp_col,\n                        stage_col = cfg$stage_col)\n      dev.off()\n    }\n  )\n  \n  # Mass loss plot with stage boundaries\n  output$process_plot <- renderPlot({\n    req(rv$processed)\n    plot(rv$processed,\n         plot_type = \"mass\",\n         colour_segments = !isTRUE(input$colour_segments))\n  }, res = 120)\n  \n  output$dl_processed_plot <- downloadHandler(\n    filename = function() \"processed_plot_mass.png\",\n    content = function(file) {\n      req(rv$processed)\n      png(file, width = 1200, height = 1200, res = 150)\n      plot(rv$processed,\n           plot_type = \"mass\",\n           colour_segments = !isTRUE(input$colour_segments))\n      dev.off()\n    }\n  )\n  \n  # --------------------------------------------------------------------------\n  # Deconvolution\n  # --------------------------------------------------------------------------\n  \n  # Run deconvolution analysis on processed data\n  # This separates the pyrolysis curve into component peaks (hemicellulose, cellulose, lignin)\n  observeEvent(input$run_decon, {\n    req(rv$processed)\n    # Convert UI selection to numeric or NULL for auto-detection\n    np <- switch(input$n_peaks, auto = NULL, `3` = 3, `4` = 4)\n    rv$decon <- NULL  # hide outputs/download until fresh results are ready\n    decon_res <- NULL\n    withProgress(message = \"Deconvolving...\", value = 0, {\n      decon_res <- tryCatch({\n        deconvolve(rv$processed, seed = input$decon_seed, n_peaks = np)\n      }, error = function(e) {\n        rv$decon <- NULL\n        showNotification(\n          paste(\n            \"Deconvolution failed. Check temperature units, pyrolysis window, and data quality.\",\n            e$message\n          ),\n          type = \"error\",\n          duration = 10\n        )\n        NULL\n      })\n    })\n    if (is.null(decon_res)) return()\n    rv$decon <- decon_res\n  })\n  \n  # --------------------------------------------------------------------------\n  # Deconvolution Results Display\n  # --------------------------------------------------------------------------\n  \n  # Display deconvolution weights table\n  output$weights_tbl <- renderDataTable({\n    req(rv$decon)\n    df <- rv$decon$weights\n    numeric_cols <- which(vapply(df, is.numeric, logical(1)))\n    dt <- datatable(df, options = list(dom = \"t\"))\n    if (length(numeric_cols)) {\n      dt <- formatRound(dt, columns = numeric_cols, digits = 2)\n    }\n    dt\n  })\n  \n  output$dl_weights_tbl <- downloadHandler(\n    filename = function() \"decon_weights.csv\",\n    content = function(file) {\n      req(rv$decon)\n      df <- rv$decon$weights\n      numeric_cols <- which(vapply(df, is.numeric, logical(1)))\n      if (length(numeric_cols)) {\n        df[numeric_cols] <- lapply(df[numeric_cols], round, 2)\n      }\n      write.csv(df, file, row.names = FALSE)\n    }\n  )\n  \n  # Deconvolution plot with optional quantile bands\n  output$decon_plot <- renderPlot({\n    req(rv$decon)\n    probs <- parse_probs(input$band_probs)\n    plot(rv$decon,\n         bw = input$decon_bw,\n         show_quantile_band = input$show_band,\n         quantile_probs = probs,\n         n_draws = input$band_draws,\n         seed = input$band_seed)\n  }, res = 120)\n  \n  output$dl_decon_plot <- downloadHandler(\n    filename = function() \"decon_plot.png\",\n    content = function(file) {\n      req(rv$decon)\n      png(file, width = 1200, height = 1200, res = 150)\n      probs <- parse_probs(input$band_probs)\n      plot(rv$decon,\n           bw = input$decon_bw,\n           show_quantile_band = input$show_band,\n           quantile_probs = probs,\n           n_draws = input$band_draws,\n           seed = input$band_seed)\n      dev.off()\n    }\n  )\n\n  # --------------------------------------------------------------------------\n  # Carbon Fraction Calculations\n  # --------------------------------------------------------------------------\n  \n  # Format carbon fraction values into a two-column table for display/download.\n  fraction_table <- function(vals) {\n    data.frame(\n      Component = c(\n        \"Moisture\",\n        \"Hemicellulose volatile\", \"Cellulose volatile\", \"Lignin volatile\",\n        \"Hemicellulose fixed carbon\", \"Cellulose fixed carbon\", \"Lignin fixed carbon\",\n        \"Hemicellulose total\", \"Cellulose total\", \"Lignin total\",\n        \"Ash\"\n      ),\n      Percent = round(c(\n        vals$moisture,\n        vals$vol_H, vals$vol_C, vals$vol_L,\n        vals$fc_H, vals$fc_C, vals$fc_L,\n        vals$total_H, vals$total_C, vals$total_L,\n        vals$ash\n      ), 2),\n      check.names = FALSE\n    )\n  }\n  \n  #' Calculate carbon fraction values for display\n  #'\n  #' Computes moisture, ash, volatile, fixed carbon, and total fractions for\n  #' hemicellulose, cellulose, and lignin. Only works with 3-peak deconvolutions.\n  #'\n  #' @return Named list with all fraction values (moisture, ash, vol_H, vol_C, etc.)\n  #' @note This is a reactive expression that recalculates when dependencies change\n  fraction_values <- reactive({\n    req(rv$processed, rv$decon)\n    if (is.null(rv$decon$n_peaks) || rv$decon$n_peaks != 3) {\n      stop(\"Carbon fractions currently supported for 3 peaks. Please deconvolve with 3 peaks (or Auto -> 3).\")\n    }\n\n    # Helper to safely extract values, returning NA if missing\n    val_or_na <- function(x) if (is.null(x) || length(x) == 0) NA_real_ else x\n\n    moisture <- val_or_na(mixchar:::calculate_moisture_content(rv$processed))\n    ash <- val_or_na(mixchar:::calculate_ash_content(rv$processed))\n    fc <- calculate_fixed_carbon_fractions(\n      rv$decon,\n      dry_basis_fixed_carbon_hemicellulose = input$fc_hemi,\n      dry_basis_fixed_carbon_cellulose = input$fc_cell,\n      dry_basis_fixed_carbon_lignin = input$fc_lig\n    )\n    totals <- mixchar:::calculate_total_fractions(rv$decon, fc)\n\n    # Extract fraction values, handling both new and legacy field names\n    # New names: volatile_HC_fraction, fixed_carbon_HC_fraction, etc.\n    # Legacy names: Hvp, Hfp, etc. (used as fallback)\n    vol_H <- val_or_na(if (!is.null(fc$volatile_HC_fraction)) fc$volatile_HC_fraction else fc$Hvp)\n    vol_C <- val_or_na(if (!is.null(fc$volatile_CL_fraction)) fc$volatile_CL_fraction else fc$Cvp)\n    vol_L <- val_or_na(if (!is.null(fc$volatile_LG_fraction)) fc$volatile_LG_fraction else fc$Lvp)\n    fc_H <- val_or_na(if (!is.null(fc$fixed_carbon_HC_fraction)) fc$fixed_carbon_HC_fraction else fc$Hfp)\n    fc_C <- val_or_na(if (!is.null(fc$fixed_carbon_CL_fraction)) fc$fixed_carbon_CL_fraction else fc$Cfp)\n    fc_L <- val_or_na(if (!is.null(fc$fixed_carbon_LG_fraction)) fc$fixed_carbon_LG_fraction else fc$Lfp)\n\n    list(\n      moisture = moisture,\n      ash = ash,\n      vol_H = vol_H,\n      vol_C = vol_C,\n      vol_L = vol_L,\n      fc_H = fc_H,\n      fc_C = fc_C,\n      fc_L = fc_L,\n      total_H = val_or_na(totals$H_total),\n      total_C = val_or_na(totals$C_total),\n      total_L = val_or_na(totals$L_total)\n    )\n  })\n  \n  output$fractions_tbl <- renderDataTable({\n    vals <- tryCatch(fraction_values(), error = function(e) {\n      validate(need(FALSE, e$message))\n    })\n\n    tbl <- fraction_table(vals)\n    \n    datatable(\n      tbl,\n      options = list(\n        dom = \"t\",\n        paging = FALSE,\n        scrollY = \"60vh\"\n      )\n    )\n  })\n  \n  output$dl_fractions_tbl <- downloadHandler(\n    filename = function() \"carbon_fractions.csv\",\n    content = function(file) {\n      vals <- fraction_values()\n      tbl <- fraction_table(vals)\n      write.csv(tbl, file, row.names = FALSE)\n    }\n  )\n\n  output$fractions_sankey <- renderPlotly({\n    vals <- tryCatch(fraction_values(), error = function(e) {\n      validate(need(FALSE, e$message))\n    })\n    render_fractions_sankey(vals)\n  })\n\n  output$dl_repro_script <- downloadHandler(\n    filename = function() \"mixchar_reproducible_analysis.R\",\n    content = function(file) {\n      req(rv$processed, rv$decon)\n      writeLines(build_repro_script(), con = file, useBytes = TRUE)\n    }\n  )\n  \n  # --------------------------------------------------------------------------\n  # Dynamic UI Rendering\n  # --------------------------------------------------------------------------\n  \n  #' Render main content area based on selected workflow step\n  #'\n  #' Dynamically generates the main panel content based on which step the user\n  #' has selected. Each step shows different outputs and controls.\n  #'\n  #' Steps:\n  #'   - read: Data upload and preview\n  #'   - process: Processing results, stage summary, plots\n  #'   - decon: Deconvolution weights table\n  #'   - viz: Deconvolution visualization\n  #'   - fractions: Carbon fractions table or Sankey diagram\n  output$step_body <- renderUI({\n    switch(input$step,\n           read = tagList(\n             h3(\"1. Load data\"),\n             p(\"Upload your CSV or use the built-in beech_example.csv; set skip rows if metadata is present.\"),\n             DTOutput(\"raw_preview\", height = \"60vh\")\n           ),\n           process = {\n             base <- tagList(\n               h3(\"2. Process data\"),\n               p(\"Run process() and inspect stage boundaries.\")\n             )\n             if (is.null(rv$processed)) return(base)\n             tagList(\n               base,\n               div(\n                 class = \"d-flex align-items-center justify-content-between mb-2\",\n                 h4(\"Stage summary\"),\n                 downloadButton(\"dl_stage_summary\", \"Download table\", class = \"btn-secondary btn-sm\")\n               ),\n               DTOutput(\"stage_summary_tbl\"),\n               br(),\n               h4(\"Visualize data\"),\n               div(\n                 class = \"d-flex align-items-center gap-4 mb-2\",\n                 {\n                   temp_checked <- if (is.null(input$show_temp_plot)) TRUE else isTRUE(input$show_temp_plot)\n                   checkboxInput(\"show_temp_plot\", \"Temperature program\", value = temp_checked)\n                 },\n                 {\n                   mass_checked <- if (is.null(input$show_mass_plot)) TRUE else isTRUE(input$show_mass_plot)\n                   checkboxInput(\"show_mass_plot\", \"Mass loss\", value = mass_checked)\n                 }\n               ),\n               {\n                 show_temp <- if (is.null(input$show_temp_plot)) TRUE else isTRUE(input$show_temp_plot)\n                 show_mass <- if (is.null(input$show_mass_plot)) TRUE else isTRUE(input$show_mass_plot)\n                 both <- show_temp && show_mass\n                 \n                 plots <- list()\n                 if (show_temp) {\n                   plots[[length(plots) + 1]] <- column(\n                     width = if (both) 6 else 12,\n                     div(\n                       class = \"d-flex align-items-center justify-content-between mb-2\",\n                       span(),\n                       downloadButton(\"dl_temp_program_plot\", \"Download plot\", class = \"btn-primary\")\n                     ),\n                     plotOutput(\"temp_program_plot\", height = \"520px\")\n                   )\n                 }\n                 if (show_mass) {\n                   plots[[length(plots) + 1]] <- column(\n                     width = if (both) 6 else 12,\n                     div(\n                       class = \"d-flex align-items-center justify-content-between mb-2\",\n                       checkboxInput(\"colour_segments\", \"Black/white only (hide stage annotations)\", value = FALSE),\n                       downloadButton(\"dl_processed_plot\", \"Download plot\", class = \"btn-primary\")\n                     ),\n                     plotOutput(\"process_plot\", height = \"520px\")\n                   )\n                 }\n                 \n                 if (length(plots) == 0) {\n                   helpText(\"Select at least one plot to display.\")\n                 } else {\n                   do.call(fluidRow, plots)\n                 }\n               }\n             )\n           },\n           decon = tagList(\n             div(\n               class = \"d-flex align-items-center justify-content-between mb-2\",\n               h3(\"3. Pyrolysis phase deconvolution\"),\n               if (!is.null(rv$decon)) {\n                 downloadButton(\"dl_weights_tbl\", \"Download table\", class = \"btn-secondary btn-sm\")\n               }\n             ),\n             p(\"Weights table from deconvolve().\"),\n             DTOutput(\"weights_tbl\")\n           ),\n           viz = tagList(\n             h3(\"4. Pyrolysis phase deconvolution plots\"),\n             fluidRow(\n               column(\n                 width = 12,\n                 align = \"right\",\n                 if (!is.null(rv$decon)) {\n                   downloadButton(\"dl_decon_plot\", \"Download decon plot\", class = \"btn-primary\")\n                 }\n               )\n             ),\n             plotOutput(\"decon_plot\", height = \"520px\")\n           ),\n            fractions = tagList(\n              div(\n                class = \"position-relative mb-2\",\n                h3(\"5. Carbon fractions\"),\n                if (!is.null(rv$processed) && !is.null(rv$decon)) {\n                  div(\n                   class = \"d-flex flex-column align-items-end gap-1\",\n                   style = \"position:absolute; top:0; right:-12px;\",\n                   downloadButton(\"dl_fractions_tbl\", \"Download table\", class = \"btn-secondary btn-sm\")\n                  )\n                }\n              ),\n              p(\"Adjust assumed fixed carbon percentages for each pseudo-component in the sidebar if needed.\"),\n              if (isTRUE(input$show_sankey)) {\n                plotlyOutput(\"fractions_sankey\", height = \"640px\")\n              } else {\n                DTOutput(\"fractions_tbl\")\n              },\n              if (!is.null(rv$processed) && !is.null(rv$decon)) {\n                div(\n                  class = \"d-flex justify-content-end mt-3\",\n                  downloadButton(\"dl_repro_script\", \"Reproducible R script\", class = \"btn-outline-primary btn-sm\")\n                )\n              }\n            )\n    )\n  })\n}\n","type":"text"},{"name":"ui.R","content":"# ============================================================================\n# ui.R - Shiny User Interface for mixchar GUI\n# ============================================================================\n#\n# Purpose:\n#   Defines the user interface layout and styling for the mixchar Shiny workbench.\n#   Uses a sidebar layout with workflow step navigation and conditional panels\n#   for step-specific controls.\n#\n# Structure:\n#   - Sidebar (width 3): Workflow step selector + conditional input panels\n#   - Main panel (width 9): Dynamic content rendered by server.R (output$step_body)\n#\n# Workflow Steps:\n#   1. read: Data upload/example selection\n#   2. process: Column mapping and processing parameters\n#   3. decon: Deconvolution parameters (peaks, seed)\n#   4. viz: Visualization options (bw, quantile bands)\n#   5. fractions: Carbon fraction parameters and display options\n#\n# UI Components:\n#   - conditionalPanel: Shows/hides inputs based on selected step\n#   - uiOutput(\"step_body\"): Main content area (rendered server-side)\n#   - uiOutput(\"datafile_ui\"): Dynamic file input (allows reset)\n#\n# Styling:\n#   - Uses bslib for Bootstrap 5 theming\n#   - Custom CSS for sidebar gradient and main panel styling\n#   - Google Fonts: Barlow (base), Space Grotesk (headings)\n#\n# Modification Notes:\n#   - To add a new workflow step: add to radioButtons choices and create new conditionalPanel\n#   - Input IDs must match server.R input$<id> references\n#   - Use conditionalPanel(\"input.step == '<step_name>'\") for step-specific UI\n#\n# ============================================================================\n\nlibrary(shiny)\nlibrary(bslib)\nlibrary(DT)\nlibrary(plotly)\n\n# Application theme configuration\n# Customizes Bootstrap 5 appearance with specific colors and fonts\napp_theme <- bs_theme(\n  version = 5,\n  base_font = font_google(\"Barlow\"),\n  heading_font = font_google(\"Space Grotesk\"),\n  primary = \"#0f766e\",\n  secondary = \"#f97316\",\n  bg = \"#f4f6fb\",\n  fg = \"#0f172a\"\n)\n\n# ============================================================================\n# Main UI Definition\n# ============================================================================\n\nui <- fluidPage(\n  theme = app_theme,\n  # Custom CSS for sidebar gradient and main panel styling\n  tags$head(tags$style(\n    \"\n    .sidebarPanel { background: linear-gradient(180deg,#0f172a 0%,#0f766e 100%); color:#f8fafc; }\n    .main-panel { background:#f8fafc; border-radius:12px; padding:18px; position:relative; }\n    .shiny-input-container { margin-bottom:12px; }\n    \"\n  )),\n  titlePanel(h1(\"mixchar Shiny workbench\", class = \"mb-0\")),\n  sidebarLayout(\n    # ------------------------------------------------------------------------\n    # Sidebar: Workflow Navigation and Step-Specific Controls\n    # ------------------------------------------------------------------------\n    sidebarPanel(\n      width = 3,\n      h4(\"Workflow steps\"),\n      # Step selector: Controls which step is active and which conditionalPanel shows\n      radioButtons(\n        \"step\", label = NULL,\n        choices = c(\n        \"1. Load data\" = \"read\",\n        \"2. Process data\" = \"process\",\n        \"3. Pyrolysis phase deconvolution\" = \"decon\",\n        \"4. Pyrolysis phase deconvolution plots\" = \"viz\",\n        \"5. Carbon fractions\" = \"fractions\"\n      ),\n      selected = \"read\"\n    ),\n    hr(),\n      # ----------------------------------------------------------------------\n      # Step 1: Data Loading\n      # ----------------------------------------------------------------------\n      conditionalPanel(\n        \"input.step == 'read'\",\n        uiOutput(\"datafile_ui\"),\n        div(\n          class = \"mb-2\",\n          tags$label(\"Rows to skip (metadata)\", `for` = \"skip_rows\", class = \"form-label mb-1\"),\n          div(\n            class = \"d-flex align-items-center gap-2\",\n            numericInput(\n              \"skip_rows\", label = NULL,\n              value = 0, min = 0, step = 1, width = \"160px\"\n            ),\n            actionButton(\"apply_skip\", \"Apply\", class = \"btn-secondary btn-sm\")\n          )\n        ),\n        actionButton(\"use_example\", \"Use example data\", class = \"btn-secondary\")\n      ),\n      # ----------------------------------------------------------------------\n      # Step 2: Data Processing\n      # ----------------------------------------------------------------------\n      conditionalPanel(\n        \"input.step == 'process'\",\n        helpText(\"Example data fills defaults; provide values for your own data.\"),\n        selectInput(\"temp_col\", \"Temperature column\", choices = c(\"Select column\" = \"\")),\n        selectInput(\n          \"temp_units\",\n          \"Temperature units\",\n          choices = c(\"Celsius (C)\" = \"C\", \"Kelvin (K)\" = \"K\"),\n          selected = \"C\"\n        ),\n        selectInput(\"mass_col\", \"Mass loss column\", choices = c(\"Select column\" = \"\")),\n        selectInput(\"time_col\", \"Time column\", choices = c(\"Select column\" = \"\")),\n        selectInput(\"stage_col\", \"Stage column (optional, for plotting)\", choices = c(\"Select column\" = \"\")),\n        numericInput(\"init_mass\", \"Initial mass (mg)\", value = NA, min = 0, step = 0.01),\n        numericInput(\"pyro_start\", \"Pyrolysis start time\", value = NA, step = 0.5),\n        numericInput(\"pyro_end\", \"Pyrolysis end time\", value = NA, step = 0.5),\n        actionButton(\"do_process\", \"Run process\", class = \"btn-primary\")\n      ),\n      # ----------------------------------------------------------------------\n      # Step 3: Deconvolution\n      # ----------------------------------------------------------------------\n      conditionalPanel(\n        \"input.step == 'decon'\",\n        selectInput(\"n_peaks\", \"Number of peaks\", choices = c(\"Auto\" = \"auto\", \"3 peaks\" = \"3\", \"4 peaks\" = \"4\")),\n        numericInput(\"decon_seed\", \"Seed\", value = 1, min = 1, step = 1),\n        actionButton(\"run_decon\", \"Run deconvolve\", class = \"btn-primary\")\n      ),\n      # ----------------------------------------------------------------------\n      # Step 4: Visualization Options\n      # ----------------------------------------------------------------------\n      conditionalPanel(\n        \"input.step == 'viz'\",\n        checkboxInput(\"decon_bw\", \"Black/white plot\", value = TRUE),\n        checkboxInput(\"show_band\", \"Show quantile bands (3-peak only)\", value = FALSE),\n        textInput(\"band_probs\", \"Quantile probs\", value = \"0.025, 0.5, 0.975\"),\n        numericInput(\"band_draws\", \"Draws for ribbons\", value = 500, min = 50, step = 50),\n        numericInput(\"band_seed\", \"Ribbon seed\", value = 42, min = 1, step = 1)\n      ),\n      # ----------------------------------------------------------------------\n      # Step 5: Carbon Fractions\n      # ----------------------------------------------------------------------\n      conditionalPanel(\n        \"input.step == 'fractions'\",\n        checkboxInput(\n          \"show_sankey\",\n          \"Show Sankey diagram (replaces table)\",\n          value = FALSE\n        ),\n        numericInput(\n          \"fc_hemi\",\n          \"Hemicellulose fixed carbon (% dry basis)\",\n          value = 13.8, min = 0, step = 0.1\n        ),\n        numericInput(\n          \"fc_cell\",\n          \"Cellulose fixed carbon (% dry basis)\",\n          value = 6.4, min = 0, step = 0.1\n        ),\n        numericInput(\n          \"fc_lig\",\n          \"Lignin fixed carbon (% dry basis)\",\n          value = 34, min = 0, step = 0.1\n        )\n      )\n    ),\n    # ------------------------------------------------------------------------\n    # Main Panel: Dynamic Content Area\n    # ------------------------------------------------------------------------\n    # Content is rendered server-side based on selected step (see server.R output$step_body)\n    mainPanel(\n      width = 9,\n      class = \"main-panel\",\n      uiOutput(\"step_body\")\n    )\n  )\n)\n","type":"text"},{"name":"README.md","content":"# mixchar-gui\n\nShiny GUI for the `mixchar` package (thermogravimetric deconvolution).\n\n## Overview\n\nThis Shiny application provides an interactive workbench for analyzing thermogravimetric data through the mixchar package. It guides users through a five-step workflow: data loading, processing, deconvolution, visualization, and carbon fraction calculation.\n\n## Requirements\n- R (>= 4.0)\n- `mixchar` package â€” **fixed_carbon branch** (latest carbon-fraction work)  \n  ```r\n  install.packages(\"remotes\")  # if remotes is not installed\n  remotes::install_github(\"smwindecker/mixchar\", ref = \"fixed_carbon\")\n  # or install from your local fixed_carbon checkout:\n  # remotes::install_local(\"/path/to/mixchar\")\n  ```\n- Shiny runtime (`shiny`, `DT`) and `plotly` for the Sankey diagram:  \n  ```r\n  install.packages(c(\"shiny\", \"DT\", \"plotly\"))\n  ```\n\n### Quick install & run (copy-paste)\n```r\ninstall.packages(c(\"shiny\",\"DT\",\"bslib\",\"plotly\",\"remotes\"), repos = \"https://cloud.r-project.org\")\nremotes::install_github(\"smwindecker/mixchar\", ref = \"fixed_carbon\", upgrade = \"never\")\nshiny::runApp(\".\")\n```\n\n## Getting the GUI\n- Download/clone the GUI repo: <https://github.com/smwindecker/mixchar-gui>\n- (Already here) place the example data `beech_example.csv` in the repo root; keep `ui.R` and `server.R` together.\n\n## Run\nIn the repo root:\n```r\nshiny::runApp(\".\")\n```\n\n## Notes\n- Make sure the `mixchar` fixed-carbon branch is installed before running the GUI.\n- You can upload your own CSV in the app and set skip rows/column mapping; or use the bundled `beech_example.csv`.\n\n---\n\n## Architecture & Code Structure\n\n### File Organization\n\n- **`ui.R`**: User interface definition\n  - Sidebar layout with workflow step navigation\n  - Conditional panels for step-specific inputs\n  - Dynamic content area (rendered server-side)\n\n- **`server.R`**: Server-side logic and data processing\n  - Reactive state management (`rv` reactiveValues)\n  - Data processing, deconvolution, and fraction calculations\n  - Output rendering and download handlers\n\n- **`sankey.R`**: Sankey diagram visualization\n  - Carbon fraction flow visualization\n  - Plotly-based interactive diagrams\n\n### Application State Management\n\nThe app uses Shiny's `reactiveValues` (`rv`) to manage state:\n\n- `rv$raw`: Raw uploaded/example data\n- `rv$processed`: Processed data from `mixchar::process()`\n- `rv$decon`: Deconvolution results from `mixchar::deconvolve()`\n- `rv$source`: Data source identifier (\"upload\", \"example\", or \"none\")\n- `rv$file_reset`: Counter for file input reset\n- `rv$example_path`: Path to example data file\n\n### Workflow Steps\n\n1. **Load data** (`input$step == \"read\"`)\n   - Upload CSV or use example data\n   - Configure skip rows for metadata\n\n2. **Process data** (`input$step == \"process\"`)\n   - Map columns (temperature, mass loss, time, stage)\n   - Set processing parameters (initial mass, pyrolysis window)\n   - View stage summary and plots\n\n3. **Deconvolution** (`input$step == \"decon\"`)\n   - Configure peak count (auto, 3, or 4)\n   - Set random seed for reproducibility\n   - View weights table\n\n4. **Visualization** (`input$step == \"viz\"`)\n   - Configure plot appearance (bw, quantile bands)\n   - View deconvolution plots\n\n5. **Carbon fractions** (`input$step == \"fractions\"`)\n   - Adjust fixed carbon percentages\n   - View table or Sankey diagram\n   - Export reproducible R script\n\n---\n\n## Development Guide\n\n### Adding a New Workflow Step\n\n1. **Update `ui.R`**:\n   - Add step to `radioButtons` choices in sidebar\n   - Create new `conditionalPanel` for step-specific inputs\n   - Use `conditionalPanel(\"input.step == '<step_name>'\")` syntax\n\n2. **Update `server.R`**:\n   - Add new case to `output$step_body` switch statement\n   - Create any required observers (`observeEvent`) or outputs\n   - Update `rv` reactiveValues if new state is needed\n\n3. **Example**:\n   ```r\n   # In ui.R sidebarPanel:\n   conditionalPanel(\n     \"input.step == 'newstep'\",\n     numericInput(\"new_param\", \"New Parameter\", value = 0)\n   )\n   \n   # In server.R output$step_body:\n   newstep = tagList(\n     h3(\"New Step\"),\n     plotOutput(\"new_plot\")\n   )\n   ```\n\n### Modifying Data Processing\n\n- Processing logic is in `observeEvent(input$do_process, ...)`\n- Validation occurs before processing\n- Errors are caught and displayed via `showNotification()`\n- Processing results are stored in `rv$processed`\n\n### Adding New Visualizations\n\n1. Create output renderer (e.g., `output$new_plot <- renderPlot({...})`)\n2. Add download handler if needed (e.g., `output$dl_new_plot <- downloadHandler({...})`)\n3. Include in appropriate step's UI (via `output$step_body`)\n\n### Modifying Sankey Diagram\n\n- Edit `sankey.R` functions:\n  - `build_sankey_labels()`: Change node label formatting\n  - `render_fractions_sankey()`: Modify layout, colors, or links\n- Node positions: Adjust `node_x` and `node_y` arrays\n- Colors: Modify `col_hemi`, `col_cell`, etc.\n- Links: Update `link_sources`, `link_targets`, `link_values` arrays\n\n### Code Style & Documentation\n\n- Functions are documented with purpose, parameters, and return values\n- Complex logic includes inline comments explaining \"why\"\n- File headers describe purpose, architecture, and modification notes\n- Use `req()` to ensure dependencies before rendering outputs\n- Use `validate(need(...))` for user input validation\n\n### Testing Changes\n\n1. Ensure `mixchar` fixed-carbon branch is installed\n2. Run `shiny::runApp(\".\")` from project root\n3. Test each workflow step with example data\n4. Verify error handling with invalid inputs\n5. Check download handlers produce correct files\n\n### Common Modifications\n\n**Change default values**:\n- Edit `example_defaults` list in `server.R`\n- Modify `value` parameters in `ui.R` inputs\n\n**Add new input field**:\n- Add to appropriate `conditionalPanel` in `ui.R`\n- Access via `input$<id>` in `server.R`\n- Update validation if required\n\n**Modify color scheme**:\n- Edit `app_theme` in `ui.R` for overall theme\n- Edit color variables in `sankey.R` for diagram colors\n- Modify CSS in `tags$style()` for custom styling\n\n---\n\n## Troubleshooting\n\n- **\"mixchar fixed-carbon branch required\"**: Install via `remotes::install_github('smwindecker/mixchar', ref = 'fixed-carbon')`\n- **Processing fails**: Check temperature units match data (C vs K), verify pyrolysis window is appropriate\n- **Deconvolution fails**: Ensure processing completed successfully, check data quality\n- **Sankey diagram missing**: Requires 3-peak deconvolution; run deconvolution with 3 peaks first\n","type":"text"},{"name":"To-Do List","content":"mixchar-gui To-Do List\n\nHello, I'm Ryan, the original creator of this software package. This document lists unresolved work and optimization ideas so future contributors can pick them up quickly.\n\n1. Fix the \"Run Process\" failure when using a new test set in the Shiny UI (error: \"Processing failed. Please ensure the temperature units (C/K) match the file and the pyrolysis window is appropriate. The replacement data has 0 rows, but the dataset has 1544 rows.\").\n2. In step 2 (\"Process data\"), link the Temperature Program plot to the \"Stage column (optional, for plotting)\" selection.\n3. With the example test set, the Temperature Program plot does not perfectly match the three-stage display in Stage summary; consider mapping the three stages to three distinct colors in the plot.\n4. The fixed_carbon branch supports four peaks. After deconvolution there may be four values, but calculate_fixed_carbon_fractions() currently sums the two hemicellulose peaks. Update server.R to handle four peaks correctly and re-confirm the relevant line numbers.\n5. Refine the name matching used when retrieving outputs from calculate_fixed_carbon_fractions() in server.R. The current approach is broad to avoid mixchar naming conflicts; improve it only after confirming function naming in the mixchar package.\n6. Reduce duplicated code between the \"dl_\" download outputs and the corresponding main outputs; prefer shared helper functions so future changes stay in sync.\n7. Improve the Sankey visualization in the \"Carbon fractions\" step (e.g., reposition the \"Total Biomass (100%)\" label so it is not tied to a single flow). The current version is a rough prototype.\n8. Continue modularizing server functions: the Sankey code is already separated; similarly split other major nodes to simplify later edits or removal.\n9. (Optional) For the \"Pyrolysis phase deconvolution plot,\" add an option to plot selected carbon types individually.\n10.In the GUI's visual interface, certain buttons, fields, and outputs may require more specialized descriptions. Consulting the developers of packages like mixchar may be necessary to obtain detailed descriptive information.\n11. Clean up leftover, deprecated content in the mixchar package (e.g., the first-generation gui folder and unused functions).\n12.All references to this Shiny (GUI) currently originate from the mixchar fixed-carbon branch. Once merged, please note changes to paths and comments.","type":"text"},{"name":"beech_example.csv","content":"ï»¿#EXPORTTYPE:,DATA ALL,,,,\n#FILE:,Program 3 Mixchar2 - Buk.ngb-ss5,,,,\n#FORMAT:,NETZSCH5,,,,\n#FTYPE:,UNICODE,,,,\n#IDENTITY:,Program 3 Mixchar2 - B,,,,\n#MTYPE:,TG,,,,\n#INSTRUMENT:,NETZSCH STA 449F5,,,,\n#PROJECT:,,,,,\n#DATE/TIME:,17. 9. 2025 12:22:28 (UTC+2),,,,\n#CORR. FILE:,,,,,\n#TEMPCAL:,15/11/2022 7:48,,,,\n#SENSITIVITY:,6/12/2022 14:50,,,,\n#LABORATORY:,MTF STU,,,,\n#OPERATOR:,td,,,,\n#REMARK:,,,,,\n#SAMPLE:,Program 3 Mixchar2 - B,,,,\n#SAMPLE MASS /mg:,10.6531,,,,\n#MATERIAL:,wood,,,,\n#REFERENCE:,Empty Al2O3,,,,\n#REFERENCE MASS /mg:,0,,,,\n#TYPE OF CRUCIBLE:,\"Al2O3 85 Âµl, open\",,,,\n#SAMPLE CRUCIBLE MASS /mg:,142.9,,,,\n#REFERENCE CRUCIBLE MASS /mg:,147,,,,\n#PURGE 1 MFC:,\"OXYGEN,252,5 ml/min\",,,,\n#PURGE 2 MFC:,\"NITROGEN,250,0 ml/min\",,,,\n#PROTECTIVE MFC:,\"NITROGEN,250,0 ml/min\",,,,\n#DSC RANGE /ÂµV:,5000,,,,\n#TG RANGE /mg:,35000,,,,\n#TAU-R:,---,,,,\n#CORR. CODE:,0,,,,\n#EXO:,1,,,,\n#RANGE:,35Â°C....815Â°C/-10.0....10.0K/min,,,,\n#SEGMENT:,S1-6/6,,,,\n#SEG. 1:,35Â°C/10.0(K/min)/105Â°C,,,,\n#SEG. 2:,105Â°C/02:00/105Â°C,,,,\n#SEG. 3:,105Â°C/10.0(K/min)/750Â°C,,,,\n#SEG. 4:,750Â°C/10.0(K/min)/600Â°C,,,,\n#SEG. 5:,600Â°C/3.6(K/min)/815Â°C,,,,\n#SEG. 6:,815Â°C/02:00/815Â°C,,,,\n,,,,,\ntemp,time,mass_loss,dtg,sensitivity,stage\n32.488,0,0.000000E+0,-6.04E-02,0.98674,1\n33.01164,0.25,-1.12E-02,-4.17E-02,0.98631,1\n33.602,0.5,-2.09E-02,-4.11E-02,0.98583,1\n34.36048,0.75,-3.05E-02,-4.15E-02,0.98521,1\n35.32,1,-4.25E-02,-4.67E-02,0.98443,1\n36.54471,1.25,-5.36E-02,-4.91E-02,0.98343,1\n38.013,1.5,-6.72E-02,-5.02E-02,0.98223,1\n39.6926,1.75,-7.84E-02,-5.27E-02,0.98086,1\n41.606,2,-9.38E-02,-5.86E-02,0.9793,1\n43.64971,2.25,-0.10776,-6.11E-02,0.97763,1\n45.791,2.5,-0.1245,-6.70E-02,0.97588,1\n48.04534,2.75,-0.14104,-7.44E-02,0.97404,1\n50.358,3,-0.15946,-7.41E-02,0.97215,1\n52.73008,3.25,-0.18016,-8.28E-02,0.97021,1\n55.164,3.5,-0.20085,-8.37E-02,0.96822,1\n57.6632,3.75,-0.22271,-8.79E-02,0.96617,1\n60.214,4,-0.24574,-9.01E-02,0.96409,1\n62.87382,4.25,-0.26709,-8.66E-02,0.96191,1\n65.6,4.5,-0.2878,-8.53E-02,0.95967,1\n68.37339,4.75,-0.3092,-8.36E-02,0.9574,1\n71.212,5,-0.3293,-8.34E-02,0.95507,1\n74.0772,5.25,-0.35041,-7.82E-02,0.95272,1\n76.983,5.5,-0.36878,-6.63E-02,0.95034,1\n79.92151,5.75,-0.38406,-5.98E-02,0.94793,1\n82.9,6,-0.39866,-5.79E-02,0.94549,1\n85.8739,6.25,-0.41294,-5.16E-02,0.94305,1\n88.859,6.5,-0.42618,-4.19E-02,0.9406,1\n91.86334,6.75,-0.43395,-2.81E-02,0.93814,1\n94.849,7,-0.43937,-0.11544,0.93569,1\n97.759,7.25,-0.4458,-2.10E-02,0.93331,2\n100.45,7.5,-0.44986,-1.53E-02,0.9311,2\n102.832,7.75,-0.45256,-1.07E-02,0.92915,2\n104.881,8,-0.4546,-7.34E-03,0.92747,2\n106.61,8.25,-0.45618,-5.16E-03,0.92606,2\n108.011,8.5,-0.45753,-3.97E-03,0.92491,2\n109.136,8.75,-0.45628,-3.38E-03,0.92399,2\n109.977,9,-0.45934,-3.02E-03,0.9233,2\n110.608,9.25,-0.45821,-2.52E-03,0.92279,2\n111.014,9.5,-0.46171,-1.44E-03,0.92246,2\n111.264,9.75,-0.46035,-1.24E-04,0.92225,2\n111.399,10,-0.45764,3.549400E-4,0.92214,2\n111.465,10.25,-0.459,4.267385E-5,0.92209,2\n111.46,10.5,-0.46035,-3.72E-04,0.92209,2\n111.423,10.75,-0.45866,-9.62E-04,0.92212,2\n111.376,11,-0.46001,-1.40E-03,0.92216,2\n111.31,11.25,-0.46148,-7.64E-04,0.92221,2\n111.237,11.5,-0.46159,4.291067E-4,0.92227,2\n111.13,11.75,-0.45888,5.937264E-4,0.92236,2\n111.02,12,-0.45922,-3.60E-04,0.92245,2\n110.873,12.25,-0.46024,-1.03E-03,0.92257,2\n110.722,12.5,-0.46159,-7.02E-04,0.92269,2\n110.563,12.75,-0.46159,-1.24E-04,0.92282,2\n110.366,13,-0.45922,-1.67E-04,0.92299,2\n110.155,13.25,-0.46159,-4.60E-04,0.92316,2\n109.935,13.5,-0.46159,-4.22E-04,0.92334,2\n109.728,13.75,-0.46058,-4.23E-04,0.92351,2\n109.508,14,-0.46091,-6.93E-04,0.92369,2\n109.282,14.25,-0.46227,-7.45E-04,0.92387,2\n109.085,14.5,-0.46092,-7.59E-05,0.92403,2\n108.888,14.75,-0.46227,1.267141E-3,0.92419,2\n108.683,15,-0.46069,2.088856E-3,0.92436,2\n108.487,15.25,-0.46125,1.321902E-3,0.92452,2\n108.309,15.5,-0.4599,-5.03E-05,0.92467,2\n108.147,15.75,-0.46001,-7.14E-04,0.9248,2\n107.958,16,-0.45968,-7.64E-04,0.92496,2\n107.797,16.25,-0.46261,-4.87E-04,0.92509,2\n107.637,16.5,-0.46091,5.377407E-5,0.92522,2\n107.49,16.75,-0.46159,4.998122E-4,0.92534,2\n107.33,17,-0.46024,4.461801E-4,0.92547,2\n107.186,17.25,-0.46024,2.328384E-4,0.92559,2\n107.063,17.5,-0.46159,5.950352E-4,0.92569,2\n106.916,17.75,-0.46159,1.046138E-3,0.92581,2\n106.81,18,-0.45753,5.690925E-4,0.9259,2\n106.689,18.25,-0.46057,-3.81E-04,0.92599,2\n106.595,18.5,-0.46023,-8.12E-04,0.92607,2\n106.491,18.75,-0.45945,-7.29E-04,0.92616,2\n106.397,19,-0.46147,-4.42E-04,0.92623,2\n106.313,19.25,-0.4608,-1.01E-04,0.9263,2\n106.228,19.5,-0.4608,3.799875E-5,0.92637,2\n106.145,19.75,-0.4608,-3.99E-04,0.92644,2\n106.07,20,-0.45764,-1.41E-03,0.9265,2\n106.005,20.25,-0.46306,-1.96E-03,0.92655,2\n105.933,20.5,-0.46305,-1.47E-03,0.92661,2\n105.854,20.75,-0.46035,-7.04E-04,0.92668,2\n105.791,21,-0.46305,-1.72E-04,0.92673,2\n105.742,21.25,-0.46237,1.964725E-4,0.92677,2\n105.697,21.5,-0.46102,2.291009E-4,0.92681,2\n105.629,21.75,-0.46237,2.070019E-4,0.92686,2\n105.605,22,-0.46306,6.786132E-4,0.92688,2\n105.551,22.25,-0.4617,1.129177E-3,0.92693,2\n105.522,22.5,-0.46001,6.448201E-4,0.92695,2\n105.469,22.75,-0.46136,-3.35E-04,0.92699,2\n105.457,23,-0.46272,-7.47E-04,0.927,2\n105.41,23.25,-0.46171,-5.63E-04,0.92704,2\n105.388,23.5,-0.46171,-7.12E-05,0.92706,2\n105.379,23.75,-0.46306,8.685626E-4,0.92707,2\n105.356,24,-0.46171,1.656930E-3,0.92709,2\n105.334,24.25,-0.45933,1.334620E-3,0.9271,2\n105.328,24.5,-0.46069,2.835747E-4,0.92711,2\n105.3,24.75,-0.46204,-5.71E-04,0.92713,2\n105.299,25,-0.46171,-1.11E-03,0.92713,2\n105.29,25.25,-0.46204,-1.41E-03,0.92714,2\n105.262,25.5,-0.4617,-1.21E-03,0.92716,2\n105.229,25.75,-0.46237,-4.57E-04,0.92719,2\n105.225,26,-0.46271,4.663122E-4,0.92719,2\n105.218,26.25,-0.46238,9.959259E-4,0.9272,2\n105.204,26.5,-0.46136,6.275797E-4,0.92721,2\n105.176,26.75,-0.45899,-5.94E-04,0.92723,2\n105.188,27,-0.46305,-1.55E-03,0.92722,2\n105.164,27.25,-0.46271,-1.41E-03,0.92724,2\n105.161,27.5,-0.46306,-6.92E-04,0.92725,2\n105.126,27.75,-0.4617,-7.11E-05,0.92727,2\n105.128,28,-0.4617,3.156698E-4,0.92727,2\n105.099,28.25,-0.4617,4.053203E-4,0.9273,2\n105.088,28.5,-0.46204,1.113826E-4,0.92731,2\n105.09,28.75,-0.46204,-5.96E-04,0.9273,2\n105.083,29,-0.46306,-1.52E-03,0.92731,2\n105.073,29.25,-0.4635,-1.77E-03,0.92732,2\n105.069,29.5,-0.46464,-7.35E-04,0.92732,2\n105.059,29.75,-0.46261,7.878942E-4,0.92733,2\n105.083,30,-0.46328,1.604186E-3,0.92731,2\n105.07,30.25,-0.46193,1.448210E-3,0.92732,2\n105.074,30.5,-0.46261,5.967412E-4,0.92732,2\n105.056,30.75,-0.46159,-5.81E-04,0.92733,2\n105.05,31,-0.46295,-1.40E-03,0.92734,2\n105.043,31.25,-0.46294,-1.28E-03,0.92734,2\n105.046,31.5,-0.46498,-4.89E-04,0.92734,2\n105.039,31.75,-0.46283,1.703637E-4,0.92735,2\n105.037,32,-0.46317,1.386216E-4,0.92735,2\n105.035,32.25,-0.46182,-4.02E-04,0.92735,2\n105.036,32.5,-0.46317,-7.85E-04,0.92735,2\n105.047,32.75,-0.46385,-7.69E-04,0.92734,2\n105.056,33,-0.46317,-6.80E-04,0.92733,2\n105.052,33.25,-0.46452,-7.01E-04,0.92733,2\n105.07,33.5,-0.46418,-6.18E-04,0.92732,2\n105.055,33.75,-0.46554,-2.94E-04,0.92733,2\n105.053,34,-0.46283,-1.22E-04,0.92733,2\n105.048,34.25,-0.46418,-3.12E-04,0.92734,2\n105.053,34.5,-0.46419,-5.11E-04,0.92733,2\n105.052,34.75,-0.46554,-4.86E-04,0.92733,2\n105.037,35,-0.46453,-4.06E-04,0.92735,2\n105.054,35.25,-0.46588,-5.87E-04,0.92733,2\n105.041,35.5,-0.46384,-1.00E-03,0.92734,2\n105.025,35.75,-0.46554,-1.08E-03,0.92736,2\n105.027,36,-0.46554,-4.32E-04,0.92736,2\n105.03,36.25,-0.46588,3.985014E-4,0.92735,2\n105.032,36.5,-0.46486,5.939614E-4,0.92735,2\n105.013,36.75,-0.46418,1.986469E-4,0.92737,2\n105.029,37,-0.46621,-3.47E-04,0.92735,2\n105.014,37.25,-0.46419,-9.92E-04,0.92737,2\n105.033,37.5,-0.46621,-1.43E-03,0.92735,2\n105.021,37.75,-0.46689,-1.32E-03,0.92736,2\n105.02,38,-0.46554,-1.10E-03,0.92736,2\n105.025,38.25,-0.46723,-1.20E-03,0.92736,2\n104.998,38.5,-0.46689,-1.21E-03,0.92738,2\n104.997,38.75,-0.46756,-5.83E-04,0.92738,2\n105.008,39,-0.46892,4.437934E-4,0.92737,2\n105.003,39.25,-0.46621,8.957532E-4,0.92738,2\n105.009,39.5,-0.46621,4.598926E-4,0.92737,2\n105.023,39.75,-0.46621,-1.26E-04,0.92736,2\n105.013,40,-0.46723,-2.97E-04,0.92737,2\n105.027,40.25,-0.46655,-1.11E-04,0.92736,2\n105.016,40.5,-0.46824,2.372437E-4,0.92736,2\n105,40.75,-0.46622,4.692303E-4,0.92738,2\n104.996,41,-0.46622,2.691526E-4,0.92738,2\n104.998,41.25,-0.46622,-3.13E-04,0.92738,2\n105.007,41.5,-0.46723,-9.66E-04,0.92737,2\n105.002,41.75,-0.46824,-1.52E-03,0.92738,2\n105.009,42,-0.46723,-1.75E-03,0.92737,2\n104.993,42.25,-0.46881,-1.18E-03,0.92738,2\n104.984,42.5,-0.47016,-1.42E-04,0.92739,2\n104.978,42.75,-0.46644,8.222353E-5,0.9274,2\n104.986,43,-0.46711,-4.73E-04,0.92739,2\n104.983,43.25,-0.46915,-4.80E-04,0.92739,2\n104.988,43.5,-0.46915,1.980172E-4,0.92739,2\n104.993,43.75,-0.4678,6.731718E-4,0.92738,2\n104.998,44,-0.4678,8.950978E-4,0.92738,2\n104.985,44.25,-0.46915,1.123203E-3,0.92739,2\n105.007,44.5,-0.46576,7.098054E-4,0.92737,2\n104.993,44.75,-0.46576,-5.43E-04,0.92738,2\n105.002,45,-0.46847,-1.38E-03,0.92738,2\n105.017,45.25,-0.46847,-9.71E-04,0.92736,2\n105.03,45.5,-0.46948,-1.05E-04,0.92735,2\n105.026,45.75,-0.46712,3.271817E-4,0.92736,2\n105.022,46,-0.46983,3.766049E-4,0.92736,2\n105.025,46.25,-0.46712,2.971127E-4,0.92736,2\n105.01,46.5,-0.46814,1.254270E-4,0.92737,2\n105.018,46.75,-0.46814,-1.32E-04,0.92736,2\n105.017,47,-0.46745,-3.84E-04,0.92736,2\n105.019,47.25,-0.46745,-5.42E-04,0.92736,2\n105.011,47.5,-0.46881,-6.19E-04,0.92737,2\n105.016,47.75,-0.46881,-5.56E-04,0.92736,2\n105.028,48,-0.46881,-5.55E-04,0.92735,2\n105.027,48.25,-0.46847,-1.01E-03,0.92736,2\n105.025,48.5,-0.46813,-1.44E-03,0.92736,2\n105.03,48.75,-0.46915,-8.57E-04,0.92735,2\n105.032,49,-0.4705,5.041804E-4,0.92735,2\n105.037,49.25,-0.46914,1.373246E-3,0.92735,2\n105.037,49.5,-0.46914,1.182651E-3,0.92735,2\n105.035,49.75,-0.46813,5.025935E-4,0.92735,2\n105.028,50,-0.46881,-9.05E-05,0.92735,2\n105.031,50.25,-0.46847,-5.23E-04,0.92735,2\n105.035,50.5,-0.46847,-9.06E-04,0.92735,2\n105.028,50.75,-0.46983,-1.49E-03,0.92735,2\n105.02,51,-0.46881,-2.26E-03,0.92736,2\n105.021,51.25,-0.46983,-2.25E-03,0.92736,2\n105.016,51.5,-0.47253,-8.99E-04,0.92736,2\n105.017,51.75,-0.4705,3.254855E-4,0.92736,2\n105.019,52,-0.46982,1.831025E-5,0.92736,2\n105.017,52.25,-0.47083,-8.82E-04,0.92736,2\n105.014,52.5,-0.47083,-9.67E-04,0.92737,2\n105.014,52.75,-0.4705,-3.05E-04,0.92737,2\n105.009,53,-0.47185,3.373552E-4,0.92737,2\n105.013,53.25,-0.4705,4.059532E-4,0.92737,2\n105.019,53.5,-0.4705,-1.93E-04,0.92736,2\n105.019,53.75,-0.46982,-9.86E-04,0.92736,2\n105.022,54,-0.47219,-1.19E-03,0.92736,2\n105.032,54.25,-0.47219,-5.95E-04,0.92735,2\n105.014,54.5,-0.47084,7.104650E-5,0.92737,2\n105.027,54.75,-0.47084,2.144972E-4,0.92736,2\n105.011,55,-0.47287,-8.22E-05,0.92737,2\n105.005,55.25,-0.4705,-6.54E-04,0.92737,2\n105.003,55.5,-0.47118,-1.10E-03,0.92738,2\n105.009,55.75,-0.47423,-9.08E-04,0.92737,2\n105.014,56,-0.4705,-3.28E-04,0.92737,2\n105.008,56.25,-0.47219,6.086762E-5,0.92737,2\n105.017,56.5,-0.47219,2.019959E-4,0.92736,2\n105.004,56.75,-0.47253,2.912346E-4,0.92737,2\n105.006,57,-0.47186,3.562355E-4,0.92737,2\n105.015,57.25,-0.47253,4.444212E-4,0.92737,2\n105.011,57.5,-0.4732,6.258464E-4,0.92737,2\n105.009,57.75,-0.47084,7.738834E-4,0.92737,2\n105.012,58,-0.47152,7.684991E-4,0.92737,2\n105.018,58.25,-0.47084,4.639661E-4,0.92736,2\n105.018,58.5,-0.47084,-3.99E-04,0.92736,2\n105.011,58.75,-0.47084,-1.63E-03,0.92737,2\n105.018,59,-0.47219,-2.37E-03,0.92736,2\n105.003,59.25,-0.47354,-2.05E-03,0.92738,2\n104.999,59.5,-0.47388,-1.14E-03,0.92738,2\n104.992,59.75,-0.47354,-4.93E-04,0.92738,2\n104.998,60,-0.47252,-3.32E-04,0.92738,2\n104.996,60.25,-0.47354,-2.71E-04,0.92738,2\n104.995,60.5,-0.47388,-5.49E-05,0.92738,2\n105.01,60.75,-0.47355,1.602804E-4,0.92737,2\n104.991,61,-0.47388,1.804954E-4,0.92738,2\n105.001,61.25,-0.47321,-7.38E-06,0.92738,2\n104.992,61.5,-0.47355,-1.50E-04,0.92738,2\n105.008,61.75,-0.47456,-1.37E-04,0.92737,2\n105.007,62,-0.47321,-4.12E-04,0.92737,2\n105.004,62.25,-0.47287,-1.07E-03,0.92737,2\n104.999,62.5,-0.4749,-1.24E-03,0.92738,2\n104.982,62.75,-0.47692,-5.18E-04,0.92739,2\n104.977,63,-0.47422,3.205290E-4,0.9274,2\n104.981,63.25,-0.4749,5.840821E-4,0.92739,2\n104.987,63.5,-0.4732,3.178565E-4,0.92739,2\n104.988,63.75,-0.4732,-6.65E-05,0.92739,2\n104.996,64,-0.47422,-2.85E-04,0.92738,2\n105.004,64.25,-0.47354,-5.20E-04,0.92737,2\n105.009,64.5,-0.4732,-7.44E-04,0.92737,2\n105.013,64.75,-0.47659,-6.49E-04,0.92737,2\n105.013,65,-0.47455,-4.75E-04,0.92737,2\n105.023,65.25,-0.47455,-4.96E-04,0.92736,2\n105.035,65.5,-0.47659,-4.86E-04,0.92735,2\n105.012,65.75,-0.47523,-3.83E-04,0.92737,2\n105.03,66,-0.47501,-1.61E-04,0.92735,2\n105.023,66.25,-0.47501,1.851579E-4,0.92736,2\n105.009,66.5,-0.47365,1.930026E-4,0.92737,2\n105.007,66.75,-0.47501,-2.42E-04,0.92737,2\n105.028,67,-0.47535,-3.58E-04,0.92735,2\n105.012,67.25,-0.47569,2.999346E-4,0.92737,2\n105.026,67.5,-0.47467,1.008552E-3,0.92736,2\n105.031,67.75,-0.47433,8.859066E-4,0.92735,2\n105.024,68,-0.47366,3.447791E-5,0.92736,2\n105.031,68.25,-0.47366,-8.13E-04,0.92735,2\n105.034,68.5,-0.47501,-1.20E-03,0.92735,2\n105.04,68.75,-0.47501,-1.21E-03,0.92734,2\n105.035,69,-0.47603,-1.05E-03,0.92735,2\n105.04,69.25,-0.47602,-7.30E-04,0.92734,2\n105.053,69.5,-0.47603,-1.98E-04,0.92733,2\n105.045,69.75,-0.47603,2.896022E-4,0.92734,2\n105.034,70,-0.47602,3.901133E-4,0.92735,2\n105.052,70.25,-0.47569,1.878976E-5,0.92733,2\n105.043,70.5,-0.47434,-7.62E-04,0.92734,2\n105.037,70.75,-0.47568,-1.43E-03,0.92735,2\n105.027,71,-0.47704,-1.44E-03,0.92736,2\n104.999,71.25,-0.47637,-9.79E-04,0.92738,2\n105.008,71.5,-0.47771,-4.72E-04,0.92737,2\n105.006,71.75,-0.47738,-1.93E-04,0.92737,2\n105.004,72,-0.47636,-7.51E-05,0.92737,2\n104.998,72.25,-0.47737,2.987120E-5,0.92738,2\n105.006,72.5,-0.47738,-4.61E-05,0.92737,2\n105.008,72.75,-0.47602,-3.25E-04,0.92737,2\n105.021,73,-0.47737,-5.00E-04,0.92736,2\n105.026,73.25,-0.47737,-3.74E-04,0.92736,2\n105.018,73.5,-0.47737,-5.36E-05,0.92736,2\n105.029,73.75,-0.47805,8.659945E-5,0.92735,2\n105.018,74,-0.47805,-2.07E-04,0.92736,2\n105.007,74.25,-0.47805,-5.27E-04,0.92737,2\n105.012,74.5,-0.47805,-2.78E-04,0.92737,2\n105.024,74.75,-0.47805,3.349771E-4,0.92736,2\n105.006,75,-0.4767,4.566753E-4,0.92737,2\n105.003,75.25,-0.47737,-1.47E-04,0.92738,2\n105.015,75.5,-0.47805,-7.27E-04,0.92737,2\n105.008,75.75,-0.47704,-6.07E-04,0.92737,2\n105.004,76,-0.47941,-2.01E-05,0.92737,2\n105.035,76.25,-0.47671,2.211743E-4,0.92735,2\n105.02,76.5,-0.47772,-5.77E-05,0.92736,2\n105.008,76.75,-0.47772,-3.71E-04,0.92737,2\n105.035,77,-0.47772,-6.15E-04,0.92735,2\n105.031,77.25,-0.47839,-9.71E-04,0.92735,2\n105.018,77.5,-0.47806,-1.27E-03,0.92736,2\n105.023,77.75,-0.47907,-1.07E-03,0.92736,2\n105.018,78,-0.47907,-3.59E-04,0.92736,2\n105.022,78.25,-0.47941,3.918571E-4,0.92736,2\n105.029,78.5,-0.47907,7.159688E-4,0.92735,2\n105.014,78.75,-0.47805,4.613574E-4,0.92737,2\n105.017,79,-0.47874,-1.41E-04,0.92736,2\n105.012,79.25,-0.47805,-5.84E-04,0.92737,2\n105.027,79.5,-0.48008,-5.88E-04,0.92736,2\n105.016,79.75,-0.47907,-4.37E-04,0.92736,2\n105.013,80,-0.47839,-4.96E-04,0.92737,2\n105.011,80.25,-0.4784,-7.26E-04,0.92737,2\n105.018,80.5,-0.47975,-9.47E-04,0.92736,2\n105.017,80.75,-0.47907,-9.02E-04,0.92736,2\n105.013,81,-0.48043,-3.01E-04,0.92737,2\n105.012,81.25,-0.47941,4.995581E-4,0.92737,2\n105.013,81.5,-0.47907,7.283338E-4,0.92737,2\n105.019,81.75,-0.47941,2.553659E-4,0.92736,2\n105.01,82,-0.47941,-5.38E-04,0.92737,2\n105.006,82.25,-0.47839,-1.17E-03,0.92737,2\n104.999,82.5,-0.48076,-1.13E-03,0.92738,2\n104.997,82.75,-0.47941,-6.27E-04,0.92738,2\n105.001,83,-0.48043,-4.30E-04,0.92738,2\n105.002,83.25,-0.47941,-5.78E-04,0.92738,2\n104.996,83.5,-0.4811,-4.11E-04,0.92738,2\n105.004,83.75,-0.4811,1.458231E-4,0.92737,2\n105.008,84,-0.4811,2.840197E-4,0.92737,2\n104.996,84.25,-0.4784,-4.10E-04,0.92738,2\n105.002,84.5,-0.48133,-8.04E-04,0.92738,2\n104.996,84.75,-0.48234,1.435530E-4,0.92738,2\n105.005,85,-0.482,1.376128E-3,0.92737,2\n105.012,85.25,-0.47895,1.279586E-3,0.92737,2\n105.01,85.5,-0.47895,6.650496E-5,0.92737,2\n104.995,85.75,-0.48031,-8.65E-04,0.92738,2\n105.011,86,-0.48167,-1.16E-03,0.92737,2\n105.002,86.25,-0.47895,-1.33E-03,0.92738,2\n104.988,86.5,-0.48302,-1.21E-03,0.92739,2\n105,86.75,-0.48268,-4.50E-04,0.92738,2\n104.983,87,-0.48132,2.811044E-4,0.92739,2\n104.985,87.25,-0.48031,2.121686E-4,0.92739,2\n104.974,87.5,-0.48166,-3.38E-04,0.9274,2\n104.968,87.75,-0.48065,-7.64E-04,0.9274,2\n104.984,88,-0.482,-9.20E-04,0.92739,2\n104.993,88.25,-0.482,-7.10E-04,0.92738,2\n104.996,88.5,-0.48268,-2.02E-04,0.92738,2\n104.994,88.75,-0.48234,5.361481E-5,0.92738,2\n105.004,89,-0.48201,-2.90E-04,0.92737,2\n104.997,89.25,-0.482,-8.83E-04,0.92738,2\n104.996,89.5,-0.482,-1.14E-03,0.92738,2\n105.015,89.75,-0.48471,-9.49E-04,0.92737,2\n105.001,90,-0.48132,-5.84E-04,0.92738,2\n104.986,90.25,-0.48414,2.921076E-5,0.92739,2\n104.983,90.5,-0.48347,7.546598E-4,0.92739,2\n104.981,90.75,-0.48178,8.501548E-4,0.92739,2\n104.983,91,-0.48279,3.033924E-4,0.92739,2\n104.969,91.25,-0.48144,-1.25E-04,0.9274,2\n104.96,91.5,-0.48414,-1.05E-04,0.92741,2\n104.965,91.75,-0.48212,2.009762E-5,0.92741,2\n104.969,92,-0.48313,-8.61E-05,0.9274,2\n104.965,92.25,-0.48313,-4.08E-04,0.92741,2\n104.967,92.5,-0.48212,-7.36E-04,0.9274,2\n104.975,92.75,-0.48313,-7.66E-04,0.9274,2\n104.968,93,-0.48313,-3.78E-04,0.9274,2\n104.989,93.25,-0.48414,2.322389E-4,0.92739,2\n105.005,93.5,-0.48279,7.416205E-4,0.92737,2\n105.007,93.75,-0.48414,8.208023E-4,0.92737,2\n105.015,94,-0.48212,1.869385E-4,0.92737,2\n105.028,94.25,-0.48313,-1.04E-03,0.92735,2\n105.013,94.5,-0.48313,-2.24E-03,0.92737,2\n105.019,94.75,-0.48313,-2.60E-03,0.92736,2\n105.008,95,-0.48595,-1.48E-03,0.92737,2\n105.016,95.25,-0.48629,4.152000E-4,0.92736,2\n105.023,95.5,-0.48256,1.390235E-3,0.92736,2\n104.999,95.75,-0.48324,9.967318E-4,0.92738,2\n105.007,96,-0.48459,2.397951E-4,0.92737,2\n105.012,96.25,-0.48324,-8.60E-05,0.92737,2\n105.003,96.5,-0.48459,-3.44E-05,0.92738,2\n105.02,96.75,-0.48392,-1.01E-05,0.92736,2\n105.015,97,-0.48189,-9.74E-05,0.92737,2\n105.039,97.25,-0.4846,3.465070E-5,0.92735,2\n105.038,97.5,-0.48425,2.894074E-4,0.92735,2\n105.026,97.75,-0.48223,-2.32E-05,0.92736,2\n105.034,98,-0.48358,-6.87E-04,0.92735,2\n105.018,98.25,-0.4846,-6.20E-04,0.92736,2\n105.03,98.5,-0.48595,-2.66E-05,0.92735,2\n105.033,98.75,-0.48189,-4.10E-05,0.92735,2\n105.043,99,-0.48595,-4.79E-04,0.92734,2\n105.033,99.25,-0.48459,-5.90E-04,0.92735,2\n105.093,99.5,-0.48426,-4.71E-04,0.9273,2\n105.094,99.75,-0.48426,-2.94E-04,0.9273,2\n105.087,100,-0.48493,-4.40E-05,0.92731,2\n105.1,100.25,-0.48291,9.454970E-5,0.9273,2\n105.087,100.5,-0.48561,5.026630E-5,0.92731,2\n105.085,100.75,-0.4846,-1.08E-04,0.92731,2\n105.084,101,-0.48392,-2.60E-04,0.92731,2\n105.071,101.25,-0.4846,-4.80E-05,0.92732,2\n105.071,101.5,-0.48594,5.725565E-4,0.92732,2\n105.057,101.75,-0.48358,9.247127E-4,0.92733,2\n105.071,102,-0.48324,5.146151E-4,0.92732,2\n105.066,102.25,-0.4846,-3.50E-04,0.92732,2\n105.054,102.5,-0.4846,-1.31E-03,0.92733,2\n105.044,102.75,-0.4846,-2.06E-03,0.92734,2\n105.047,103,-0.48595,-1.98E-03,0.92734,2\n105.054,103.25,-0.48561,-8.58E-04,0.92733,2\n105.043,103.5,-0.48628,4.313825E-4,0.92734,2\n105.044,103.75,-0.48426,9.368176E-4,0.92734,2\n105.028,104,-0.48561,5.662201E-4,0.92735,2\n105.048,104.25,-0.4846,-1.82E-04,0.92734,2\n105.051,104.5,-0.48595,-8.73E-04,0.92734,2\n105.027,104.75,-0.48494,-1.22E-03,0.92736,2\n105.026,105,-0.48595,-9.71E-04,0.92736,2\n105.024,105.25,-0.48731,-3.73E-04,0.92736,2\n105.014,105.5,-0.48516,1.161166E-5,0.92737,2\n105.006,105.75,-0.48787,1.640797E-4,0.92737,2\n104.984,106,-0.48584,1.226470E-4,0.92739,2\n104.993,106.25,-0.48482,-5.21E-05,0.92738,2\n104.977,106.5,-0.48651,2.385788E-4,0.9274,2\n104.977,106.75,-0.48651,7.000114E-4,0.9274,2\n104.985,107,-0.48448,9.088721E-5,0.92739,2\n104.977,107.25,-0.48415,-1.14E-03,0.9274,2\n104.99,107.5,-0.48854,-1.33E-03,0.92739,2\n104.977,107.75,-0.48686,-5.05E-04,0.9274,2\n104.99,108,-0.48787,1.120884E-4,0.92739,2\n104.984,108.25,-0.48584,2.238049E-5,0.92739,2\n104.999,108.5,-0.48719,-3.04E-04,0.92738,2\n104.986,108.75,-0.48753,-4.19E-04,0.92739,2\n104.983,109,-0.4855,-4.12E-04,0.92739,2\n104.993,109.25,-0.48685,-1.26E-04,0.92738,2\n104.995,109.5,-0.48685,5.757152E-4,0.92738,2\n104.995,109.75,-0.48719,8.897078E-4,0.92738,2\n105.007,110,-0.48448,9.562516E-6,0.92737,2\n105.01,110.25,-0.48583,-1.38E-03,0.92737,2\n105.002,110.5,-0.48719,-1.89E-03,0.92738,2\n105.024,110.75,-0.48787,-1.32E-03,0.92736,2\n105.014,111,-0.48787,-5.97E-04,0.92737,2\n105.019,111.25,-0.48685,-3.34E-04,0.92736,2\n105.031,111.5,-0.48821,-4.47E-04,0.92735,2\n105.032,111.75,-0.48753,-4.48E-04,0.92735,2\n105.026,112,-0.49046,7.987267E-5,0.92736,2\n105.017,112.25,-0.48843,3.960602E-4,0.92736,2\n105.026,112.5,-0.48573,-3.34E-04,0.92736,2\n105.024,112.75,-0.48922,-9.46E-04,0.92736,2\n105.022,113,-0.48956,-2.51E-04,0.92736,2\n105.026,113.25,-0.48821,8.168205E-4,0.92736,2\n105.025,113.5,-0.48753,8.554363E-4,0.92736,2\n105.014,113.75,-0.48618,-2.18E-04,0.92737,2\n105.021,114,-0.48786,-1.23E-03,0.92736,2\n105.015,114.25,-0.48787,-1.28E-03,0.92737,2\n105.004,114.5,-0.49057,-9.14E-04,0.92737,2\n105.002,114.75,-0.48651,-8.66E-04,0.92738,2\n104.994,115,-0.48922,-7.26E-04,0.92738,2\n105.008,115.25,-0.49057,-6.30E-05,0.92737,2\n104.993,115.5,-0.48922,6.852584E-4,0.92738,2\n104.989,115.75,-0.49057,1.029589E-3,0.92739,2\n104.998,116,-0.48787,8.550688E-4,0.92738,2\n105.01,116.25,-0.48967,3.245049E-4,0.92737,2\n105.001,116.5,-0.48798,-4.24E-04,0.92738,2\n105.022,116.75,-0.48663,-1.25E-03,0.92736,2\n105.014,117,-0.49013,-1.41E-03,0.92737,2\n105.024,117.25,-0.48979,-4.08E-04,0.92736,2\n105.038,117.5,-0.48911,9.204198E-4,0.92735,2\n105.015,117.75,-0.48877,1.187823E-3,0.92737,2\n105.019,118,-0.48775,1.438028E-4,0.92736,2\n105.015,118.25,-0.48809,-1.08E-03,0.92737,2\n105.02,118.5,-0.48945,-1.15E-03,0.92736,2\n105.013,118.75,-0.49012,9.400416E-5,0.92737,2\n105.004,119,-0.49012,1.351658E-3,0.92737,2\n105.015,119.25,-0.48742,1.376761E-3,0.92737,2\n105.01,119.5,-0.48843,4.592120E-4,0.92737,2\n104.996,119.75,-0.48708,-3.99E-04,0.92738,2\n104.995,120,-0.48978,-5.48E-04,0.92738,2\n105.003,120.25,-0.48911,-1.25E-04,0.92738,2\n104.994,120.5,-0.48775,1.050747E-4,0.92738,2\n104.999,120.75,-0.48978,-6.53E-05,0.92738,2\n105.008,121,-0.48843,-2.19E-04,0.92737,2\n104.994,121.25,-0.48877,-3.48E-04,0.92738,2\n105.005,121.5,-0.48776,-6.90E-04,0.92737,2\n105.006,121.75,-0.48978,-1.01E-03,0.92737,2\n105.018,122,-0.48843,-8.41E-04,0.92736,2\n105.005,122.25,-0.48944,-1.39E-04,0.92737,2\n105.015,122.5,-0.48944,4.523676E-4,0.92737,2\n104.995,122.75,-0.49091,2.939239E-4,0.92738,2\n105.017,123,-0.48888,-5.44E-04,0.92736,2\n105.023,123.25,-0.49023,-1.23E-03,0.92736,2\n105.022,123.5,-0.49024,-9.65E-04,0.92736,2\n105.017,123.75,-0.49023,-1.76E-04,0.92736,2\n105.014,124,-0.4899,1.200888E-4,0.92737,2\n105.014,124.25,-0.49024,-7.90E-05,0.92737,2\n105.026,124.5,-0.49023,-3.61E-04,0.92736,2\n105.015,124.75,-0.49057,-6.51E-04,0.92737,2\n105.028,125,-0.49023,-6.12E-04,0.92735,2\n105.041,125.25,-0.49158,4.452928E-5,0.92734,2\n105.044,125.5,-0.49023,6.663560E-4,0.92734,2\n105.04,125.75,-0.4899,4.025440E-4,0.92734,2\n105.048,126,-0.49057,-3.51E-04,0.92734,2\n105.048,126.25,-0.49057,-6.43E-04,0.92734,2\n105.039,126.5,-0.49091,-5.16E-04,0.92735,2\n105.04,126.75,-0.4899,-5.49E-04,0.92734,2\n105.029,127,-0.49091,7.182888E-16,0.92735,3\n105.067,127.25,-0.49125,-7.73E-04,0.92732,3\n105.328,127.5,-0.49102,3.767789E-4,0.92711,3\n105.961,127.75,-0.49035,-1.97E-03,0.92659,3\n107.035,128,-0.49182,-9.26E-04,0.92571,3\n108.568,128.25,-0.49079,1.252292E-3,0.92446,3\n110.491,128.5,-0.48911,-1.20E-03,0.92288,3\n112.665,128.75,-0.49192,-3.93E-03,0.9211,3\n115.002,129,-0.49429,-2.12E-04,0.91919,3\n117.394,129.25,-0.49317,1.764527E-3,0.91724,3\n119.793,129.5,-0.49171,1.459180E-3,0.91528,3\n122.164,129.75,-0.49305,-5.79E-04,0.91334,3\n124.541,130,-0.4917,-1.34E-04,0.9114,3\n126.926,130.25,-0.49271,1.456580E-3,0.90946,3\n129.37199,130.5,-0.4917,-5.33E-04,0.90746,3\n131.884,130.75,-0.49306,-1.18E-03,0.90542,3\n134.487,131,-0.4917,-5.64E-05,0.9033,3\n137.185,131.25,-0.4917,-3.29E-03,0.9011,3\n139.961,131.5,-0.49441,-2.30E-03,0.89885,3\n142.78799,131.75,-0.4926,-1.47E-04,0.89655,3\n145.655,132,-0.49283,-1.84E-03,0.89422,3\n148.554,132.25,-0.49418,-3.23E-03,0.89187,3\n151.41901,132.5,-0.49554,-2.23E-03,0.88955,3\n154.287,132.75,-0.49655,-1.30E-03,0.88723,3\n157.131,133,-0.49621,-2.37E-03,0.88493,3\n159.98,133.25,-0.49655,-2.30E-03,0.88263,3\n162.8,133.5,-0.49825,1.843658E-5,0.88036,3\n165.59801,133.75,-0.49722,-6.04E-04,0.87811,3\n168.424,134,-0.49723,-4.27E-03,0.87583,3\n171.22301,134.25,-0.4997,-6.31E-03,0.87359,3\n174.033,134.5,-0.50106,-3.92E-03,0.87133,3\n176.83099,134.75,-0.4997,-3.72E-03,0.86909,3\n179.619,135,-0.50343,-3.30E-03,0.86686,3\n182.403,135.25,-0.50106,-5.68E-03,0.86463,3\n185.179,135.5,-0.50523,-8.29E-03,0.86242,3\n187.914,135.75,-0.50692,-7.76E-03,0.86024,3\n190.646,136,-0.50658,-7.58E-03,0.85807,3\n193.381,136.25,-0.51234,-5.38E-03,0.85589,3\n196.09399,136.5,-0.51065,-6.63E-03,0.85374,3\n198.823,136.75,-0.51347,-1.56E-02,0.85158,3\n201.519,137,-0.52046,-1.67E-02,0.84945,3\n204.207,137.25,-0.52316,-1.30E-02,0.84733,3\n206.909,137.5,-0.52554,-1.56E-02,0.8452,3\n209.57899,137.75,-0.53038,-2.24E-02,0.8431,3\n212.22,138,-0.53546,-2.28E-02,0.84103,3\n214.873,138.25,-0.54302,-2.33E-02,0.83895,3\n217.505,138.5,-0.54651,-2.84E-02,0.83689,3\n220.134,138.75,-0.55643,-3.18E-02,0.83483,3\n222.74001,139,-0.56298,-3.16E-02,0.8328,3\n225.325,139.25,-0.5729,-3.48E-02,0.83079,3\n227.924,139.5,-0.58192,-4.14E-02,0.82877,3\n230.495,139.75,-0.59275,-4.66E-02,0.82678,3\n233.076,140,-0.60403,-5.29E-02,0.82478,3\n235.646,140.25,-0.62004,-5.90E-02,0.82279,3\n238.214,140.5,-0.63526,-6.43E-02,0.82081,3\n240.77901,140.75,-0.65128,-6.91E-02,0.81884,3\n243.33299,141,-0.66797,-7.87E-02,0.81688,3\n245.88499,141.25,-0.68804,-8.61E-02,0.81492,3\n248.435,141.5,-0.71161,-9.09E-02,0.81297,3\n250.983,141.75,-0.73372,-0.10101,0.81103,3\n253.51199,142,-0.76259,-0.11128,0.8091,3\n256.056,142.25,-0.79022,-0.12403,0.80717,3\n258.59399,142.5,-0.82631,-0.13964,0.80524,3\n261.112,142.75,-0.86104,-0.16043,0.80334,3\n263.634,143,-0.90334,-0.18956,0.80143,3\n266.16199,143.25,-0.95577,-0.21578,0.79953,3\n268.68799,143.5,-1.01024,-0.24276,0.79763,3\n271.20999,143.75,-1.07746,-0.27708,0.79574,3\n273.728,144,-1.14535,-0.31432,0.79386,3\n276.242,144.25,-1.2323,-0.34455,0.79198,3\n278.741,144.5,-1.32252,-0.37096,0.79012,3\n281.26501,144.75,-1.41747,-0.39851,0.78825,3\n283.758,145,-1.52281,-0.42531,0.7864,3\n286.26501,145.25,-1.63118,-0.44537,0.78454,3\n288.758,145.5,-1.74746,-0.46218,0.78271,3\n291.24701,145.75,-1.86158,-0.47652,0.78088,3\n293.741,146,-1.9835,-0.48885,0.77905,3\n296.245,146.25,-2.10744,-0.49737,0.77721,3\n298.73499,146.5,-2.23341,-0.50393,0.77539,3\n301.23999,146.75,-2.36039,-0.50809,0.77357,3\n303.746,147,-2.48625,-0.51248,0.77175,3\n306.245,147.25,-2.61504,-0.51935,0.76994,3\n308.73401,147.5,-2.748,-0.52506,0.76814,3\n311.22501,147.75,-2.87804,-0.52935,0.76635,3\n313.72601,148,-3.0119,-0.53513,0.76455,3\n316.22601,148.25,-3.14554,-0.54128,0.76276,3\n318.72101,148.5,-3.28098,-0.55122,0.76098,3\n321.22501,148.75,-3.42194,-0.56196,0.75919,3\n323.729,149,-3.55987,-0.5733,0.75741,3\n326.20999,149.25,-3.70941,-0.58644,0.75565,3\n328.71201,149.5,-3.85557,-0.59843,0.75389,3\n331.20099,149.75,-4.00669,-0.61502,0.75213,3\n333.702,150,-4.16164,-0.63838,0.75038,3\n336.19501,150.25,-4.32652,-0.66506,0.74863,3\n338.68201,150.5,-4.49399,-0.69526,0.74689,3\n341.17599,150.75,-4.67195,-0.73324,0.74516,3\n343.67099,151,-4.86051,-0.7723,0.74342,3\n346.147,151.25,-5.0581,-0.81887,0.74171,3\n348.63,151.5,-5.26797,-0.87494,0.74,3\n351.12701,151.75,-5.49386,-0.93085,0.73828,3\n353.608,152,-5.73418,-0.98356,0.73658,3\n356.095,152.25,-5.98771,-1.03162,0.73488,3\n358.573,152.5,-6.2516,-1.06766,0.73319,3\n361.05899,152.75,-6.52361,-1.08065,0.7315,3\n363.54999,153,-6.79563,-1.0614,0.72981,3\n366.04401,153.25,-7.06234,-1.00127,0.72813,3\n368.54999,153.5,-7.30188,-0.89817,0.72644,3\n371.07199,153.75,-7.51356,-0.75181,0.72475,3\n373.673,154,-7.68024,-0.57475,0.72301,3\n376.16,154.25,-7.80215,-0.40833,0.72136,3\n378.548,154.5,-7.88075,-0.27364,0.71977,3\n380.95499,154.75,-7.93274,-0.17651,0.71818,3\n383.39001,155,-7.96556,-0.12115,0.71657,3\n385.83801,155.25,-7.98981,-9.74E-02,0.71496,3\n388.33301,155.5,-8.01304,-8.54E-02,0.71333,3\n390.815,155.75,-8.03198,-7.59E-02,0.71171,3\n393.306,156,-8.04969,-7.17E-02,0.71009,3\n395.78,156.25,-8.06751,-7.01E-02,0.70848,3\n398.26001,156.5,-8.08465,-6.77E-02,0.70688,3\n400.73901,156.75,-8.10044,-6.71E-02,0.70528,3\n403.22198,157,-8.11724,-6.66E-02,0.70369,3\n405.70401,157.25,-8.13472,-6.24E-02,0.7021,3\n408.20901,157.5,-8.14859,-6.06E-02,0.70051,3\n410.69601,157.75,-8.16291,-6.43E-02,0.69893,3\n413.19199,158,-8.18356,-6.08E-02,0.69735,3\n415.68799,158.25,-8.19529,-5.41E-02,0.69577,3\n418.17499,158.5,-8.20814,-5.23E-02,0.69421,3\n420.65399,158.75,-8.2192,-5.32E-02,0.69266,3\n423.138,159,-8.23521,-5.38E-02,0.69111,3\n425.64099,159.25,-8.24931,-5.12E-02,0.68956,3\n428.13699,159.5,-8.26002,-4.82E-02,0.68802,3\n430.61099,159.75,-8.27367,-4.49E-02,0.68649,3\n433.095,160,-8.28268,-4.45E-02,0.68497,3\n435.58701,160.25,-8.29599,-4.56E-02,0.68344,3\n438.07001,160.5,-8.30547,-4.50E-02,0.68193,3\n440.54999,160.75,-8.3164,-4.51E-02,0.68042,3\n443.039,161,-8.32903,-4.25E-02,0.67892,3\n445.51901,161.25,-8.33851,-3.97E-02,0.67743,3\n448.00201,161.5,-8.3499,-3.94E-02,0.67594,3\n450.48401,161.75,-8.35701,-3.87E-02,0.67445,3\n452.98001,162,-8.36738,-3.78E-02,0.67297,3\n455.46799,162.25,-8.37528,-3.45E-02,0.67149,3\n457.96201,162.5,-8.38474,-3.35E-02,0.67002,3\n460.45801,162.75,-8.39287,-3.43E-02,0.66855,3\n462.939,163,-8.40291,-3.53E-02,0.6671,3\n465.44101,163.25,-8.40865,-3.46E-02,0.66564,3\n467.922,163.5,-8.42005,-3.41E-02,0.6642,3\n470.43399,163.75,-8.4276,-3.25E-02,0.66275,3\n472.92899,164,-8.43572,-3.15E-02,0.66131,3\n475.42999,164.25,-8.44328,-3.50E-02,0.65987,3\n477.92099,164.5,-8.45377,-3.60E-02,0.65845,3\n480.414,164.75,-8.46211,-3.24E-02,0.65703,3\n482.90701,165,-8.46865,-3.13E-02,0.65562,3\n485.41299,165.25,-8.47824,-3.28E-02,0.6542,3\n487.89099,165.5,-8.48512,-3.31E-02,0.65281,3\n490.38199,165.75,-8.49425,-3.07E-02,0.65142,3\n492.88199,166,-8.50079,-2.95E-02,0.65002,3\n495.38,166.25,-8.50812,-3.25E-02,0.64864,3\n497.866,166.5,-8.51771,-3.34E-02,0.64726,3\n500.35699,166.75,-8.52605,-3.18E-02,0.64589,3\n502.85001,167,-8.5335,-2.95E-02,0.64453,3\n505.34799,167.25,-8.54004,-3.11E-02,0.64317,3\n507.83899,167.5,-8.54884,-3.40E-02,0.64181,3\n510.32401,167.75,-8.55752,-3.23E-02,0.64047,3\n512.823,168,-8.56473,-3.00E-02,0.63913,3\n515.32202,168.25,-8.57026,-3.19E-02,0.63779,3\n517.81403,168.5,-8.5812,-3.20E-02,0.63646,3\n520.31,168.75,-8.58796,-2.91E-02,0.63513,3\n522.80499,169,-8.59529,-3.09E-02,0.63381,3\n525.30701,169.25,-8.60432,-3.28E-02,0.63249,3\n527.79498,169.5,-8.61166,-3.08E-02,0.63119,3\n530.28802,169.75,-8.61977,-2.81E-02,0.62989,3\n532.78601,170,-8.62519,-2.92E-02,0.62859,3\n535.27197,170.25,-8.63443,-2.95E-02,0.62731,3\n537.77197,170.5,-8.64154,-2.86E-02,0.62602,3\n540.26501,170.75,-8.64717,-2.75E-02,0.62474,3\n542.75897,171,-8.65315,-3.02E-02,0.62347,3\n545.25,171.25,-8.66296,-3.05E-02,0.6222,3\n547.75201,171.5,-8.66984,-2.69E-02,0.62094,3\n550.23401,171.75,-8.67661,-2.62E-02,0.61969,3\n552.72998,172,-8.68259,-2.93E-02,0.61844,3\n555.22198,172.25,-8.6898,-3.17E-02,0.6172,3\n557.72498,172.5,-8.69905,-2.83E-02,0.61595,3\n560.21802,172.75,-8.7048,-2.77E-02,0.61472,3\n562.71198,173,-8.71383,-2.69E-02,0.6135,3\n565.20398,173.25,-8.71789,-2.79E-02,0.61228,3\n567.69897,173.5,-8.72691,-2.95E-02,0.61106,3\n570.19397,173.75,-8.73356,-2.80E-02,0.60985,3\n572.70001,174,-8.74055,-2.79E-02,0.60864,3\n575.18799,174.25,-8.74765,-2.69E-02,0.60745,3\n577.685,174.5,-8.7533,-2.67E-02,0.60625,3\n580.172,174.75,-8.76085,-2.56E-02,0.60507,3\n582.68799,175,-8.76671,-2.49E-02,0.60388,3\n585.18103,175.25,-8.77326,-2.74E-02,0.6027,3\n587.68103,175.5,-8.78025,-2.78E-02,0.60153,3\n590.16498,175.75,-8.78724,-2.78E-02,0.60037,3\n592.67102,176,-8.79277,-2.63E-02,0.5992,3\n595.16101,176.25,-8.80077,-2.39E-02,0.59805,3\n597.66498,176.5,-8.80766,-2.33E-02,0.5969,3\n600.16699,176.75,-8.81104,-2.39E-02,0.59575,3\n602.66101,177,-8.81826,-2.54E-02,0.59462,3\n605.16199,177.25,-8.82457,-2.63E-02,0.59348,3\n607.664,177.5,-8.83224,-2.51E-02,0.59235,3\n610.15198,177.75,-8.83697,-2.43E-02,0.59123,3\n612.65997,178,-8.84465,-2.30E-02,0.59011,3\n615.15198,178.25,-8.84769,-2.31E-02,0.589,3\n617.65601,178.5,-8.85434,-2.34E-02,0.58789,3\n620.16101,178.75,-8.8619,-2.07E-02,0.58679,3\n622.66602,179,-8.86472,-2.07E-02,0.58569,3\n625.15997,179.25,-8.87047,-2.13E-02,0.5846,3\n627.64801,179.5,-8.87611,-2.11E-02,0.58352,3\n630.164,179.75,-8.88152,-2.18E-02,0.58243,3\n632.68201,180,-8.88705,-2.14E-02,0.58135,3\n635.17102,180.25,-8.89122,-2.10E-02,0.58028,3\n637.67297,180.5,-8.89675,-2.16E-02,0.57922,3\n640.17102,180.75,-8.90227,-2.14E-02,0.57816,3\n642.66498,181,-8.90791,-2.24E-02,0.5771,3\n645.16302,181.25,-8.91457,-2.13E-02,0.57605,3\n647.66498,181.5,-8.91863,-1.86E-02,0.57501,3\n650.15997,181.75,-8.92314,-1.88E-02,0.57397,3\n652.66803,182,-8.92855,-1.67E-02,0.57293,3\n655.164,182.25,-8.93058,-1.57E-02,0.5719,3\n657.67297,182.5,-8.93532,-1.83E-02,0.57088,3\n660.16699,182.75,-8.94073,-1.97E-02,0.56986,3\n662.67603,183,-8.94547,-1.92E-02,0.56884,3\n665.16699,183.25,-8.95032,-1.85E-02,0.56783,3\n667.66998,183.5,-8.95607,-1.61E-02,0.56683,3\n670.16901,183.75,-8.9581,-1.51E-02,0.56583,3\n672.659,184,-8.96182,-1.80E-02,0.56483,3\n675.159,184.25,-8.96825,-1.86E-02,0.56384,3\n677.66901,184.5,-8.97096,-1.69E-02,0.56285,3\n680.15997,184.75,-8.97705,-1.53E-02,0.56188,3\n682.66302,185,-8.97885,-1.60E-02,0.5609,3\n685.172,185.25,-8.98381,-2.16E-02,0.55992,3\n687.677,185.5,-8.99317,-1.93E-02,0.55895,3\n690.18201,185.75,-8.99351,-1.35E-02,0.55799,3\n692.69,186,-8.99757,-1.38E-02,0.55703,3\n695.16998,186.25,-9.00152,-1.39E-02,0.55608,3\n697.67603,186.5,-9.00389,-1.53E-02,0.55513,3\n700.17102,186.75,-9.00862,-1.62E-02,0.55419,3\n702.67603,187,-9.01099,-1.76E-02,0.55325,3\n705.18903,187.25,-9.01775,-1.72E-02,0.55231,3\n707.68103,187.5,-9.02159,-1.61E-02,0.55138,3\n710.18103,187.75,-9.02599,-1.68E-02,0.55045,3\n712.68701,188,-9.02904,-1.63E-02,0.54953,3\n715.19397,188.25,-9.03377,-1.26E-02,0.54861,3\n717.69702,188.5,-9.03411,-1.24E-02,0.54769,3\n720.19598,188.75,-9.03963,-1.54E-02,0.54678,3\n722.70801,189,-9.04268,-1.44E-02,0.54587,3\n725.20502,189.25,-9.04572,-1.53E-02,0.54497,3\n727.70001,189.5,-9.05091,-1.60E-02,0.54408,3\n730.20099,189.75,-9.05463,-1.53E-02,0.54319,3\n732.70697,190,-9.05734,-1.54E-02,0.5423,3\n735.20398,190.25,-9.06275,-1.39E-02,0.54141,3\n737.71002,190.5,-9.06444,-1.25E-02,0.54053,3\n740.21002,190.75,-9.06851,-1.34E-02,0.53965,3\n742.711,191,-9.07279,-1.37E-02,0.53878,3\n745.21899,191.25,-9.0755,-1.99E-02,0.53791,3\n747.71802,191.5,-9.08114,-5.71E-02,0.53705,4\n747.74902,191.75,-9.08283,-8.23E-03,0.53704,4\n745.06598,192,-9.08689,-1.05E-02,0.53796,4\n742.383,192.25,-9.08824,-1.25E-02,0.5389,4\n740.06598,192.5,-9.09252,-1.21E-02,0.5397,4\n737.95099,192.75,-9.09535,-1.09E-02,0.54045,4\n735.85602,193,-9.09805,-9.20E-03,0.54118,4\n733.729,193.25,-9.09873,-1.01E-02,0.54193,4\n731.552,193.5,-9.10358,-1.28E-02,0.54271,4\n729.33099,193.75,-9.10538,-1.19E-02,0.5435,4\n727.05499,194,-9.10967,-8.81E-03,0.54431,4\n724.73602,194.25,-9.10967,-9.28E-03,0.54514,4\n722.40198,194.5,-9.11463,-1.14E-02,0.54598,4\n720.02899,194.75,-9.11598,-8.65E-03,0.54684,4\n717.62799,195,-9.11733,-9.43E-03,0.54772,4\n715.21698,195.25,-9.12207,-1.21E-02,0.5486,4\n712.79401,195.5,-9.12321,-9.79E-03,0.54949,4\n710.35199,195.75,-9.12523,-9.68E-03,0.55039,4\n707.89899,196,-9.1303,-1.02E-02,0.5513,4\n705.44897,196.25,-9.1293,-9.26E-03,0.55221,4\n702.98297,196.5,-9.13482,-9.55E-03,0.55313,4\n700.508,196.75,-9.13482,-8.88E-03,0.55406,4\n698.03003,197,-9.13617,-1.01E-02,0.555,4\n695.54901,197.25,-9.14057,-9.15E-03,0.55594,4\n693.06702,197.5,-9.14395,-8.37E-03,0.55688,4\n690.58002,197.75,-9.1426,-1.02E-02,0.55784,4\n688.08502,198,-9.14813,-9.90E-03,0.5588,4\n685.59802,198.25,-9.14745,-7.67E-03,0.55976,4\n683.10101,198.5,-9.15151,-9.91E-03,0.56073,4\n680.612,198.75,-9.1549,-8.77E-03,0.5617,4\n678.11603,199,-9.15557,-7.13E-03,0.56268,4\n675.61603,199.25,-9.1576,-7.13E-03,0.56366,4\n673.11401,199.5,-9.15895,-8.18E-03,0.56465,4\n670.625,199.75,-9.16199,-8.29E-03,0.56564,4\n668.12598,200,-9.16402,-7.44E-03,0.56664,4\n665.62,200.25,-9.16572,-6.99E-03,0.56765,4\n663.12,200.5,-9.16707,-7.87E-03,0.56866,4\n660.60901,200.75,-9.16877,-8.87E-03,0.56968,4\n658.11401,201,-9.17214,-7.93E-03,0.57069,4\n655.62097,201.25,-9.1735,-8.66E-03,0.57172,4\n653.112,201.5,-9.17621,-9.45E-03,0.57275,4\n650.617,201.75,-9.17756,-7.73E-03,0.57378,4\n648.12097,202,-9.18027,-6.78E-03,0.57482,4\n645.61102,202.25,-9.18161,-8.80E-03,0.57587,4\n643.11401,202.5,-9.18466,-1.05E-02,0.57691,4\n640.62701,202.75,-9.18737,-7.24E-03,0.57796,4\n638.11603,203,-9.1877,-5.77E-03,0.57903,4\n635.60602,203.25,-9.18906,-7.44E-03,0.5801,4\n633.09802,203.5,-9.19143,-9.62E-03,0.58117,4\n630.60901,203.75,-9.19549,-1.01E-02,0.58224,4\n628.10498,204,-9.19617,-7.16E-03,0.58332,4\n625.60901,204.25,-9.19718,-7.02E-03,0.58441,4\n623.09998,204.5,-9.19989,-8.31E-03,0.5855,4\n620.61798,204.75,-9.20091,-8.44E-03,0.58659,4\n618.099,205,-9.20496,-6.54E-03,0.5877,4\n615.60999,205.25,-9.20496,-6.15E-03,0.5888,4\n613.11603,205.5,-9.20869,-6.82E-03,0.58991,4\n610.60498,205.75,-9.21004,-5.69E-03,0.59103,4\n608.10797,206,-9.20868,-6.96E-03,0.59215,4\n605.612,206.25,-9.21274,-1.27E-02,0.59328,4\n603.11604,206.5,-9.21614,-1.72E-02,0.59441,5\n602.067,206.75,-9.21508,-0.109,0.59489,5\n603.33107,207,-9.23299,-0.45765,0.59431,5\n605.698,207.25,-9.41958,-0.73942,0.59324,5\n607.53729,207.5,-9.71628,-0.89397,0.59241,5\n608.32194,207.75,-10.01637,-0.87278,0.59206,5\n608.50254,208,-10.27996,-0.69221,0.59197,5\n608.18434,208.25,-10.43665,-0.43957,0.59212,5\n607.45498,208.5,-10.43884,-0.21721,0.59245,5\n607.50677,208.75,-10.43614,-8.09E-02,0.59242,5\n608.046,209,-10.43512,-2.26E-02,0.59218,5\n608.69677,209.25,-10.43681,-5.79E-03,0.59189,5\n609.34923,209.5,-10.43885,-2.68E-03,0.59159,5\n610.02062,209.75,-10.43866,-2.14E-03,0.59129,5\n610.74103,210,-10.43895,-1.93E-03,0.59097,5\n611.52713,210.25,-10.43895,-1.86E-03,0.59062,5\n612.36485,210.5,-10.43896,-1.80E-03,0.59024,5\n613.22151,210.75,-10.44021,-1.58E-03,0.58986,5\n614.1399,211,-10.44051,-1.22E-03,0.58945,5\n615.0631,211.25,-10.44055,-9.04E-04,0.58904,5\n615.98246,211.5,-10.44009,-7.71E-04,0.58863,5\n616.92034,211.75,-10.4408,-7.91E-04,0.58822,5\n617.85026,212,-10.44156,-8.92E-04,0.58781,5\n618.78232,212.25,-10.44052,-9.41E-04,0.5874,5\n619.73333,212.5,-10.44186,-6.61E-04,0.58698,5\n620.67798,212.75,-10.44087,1.426048E-5,0.58656,5\n621.60151,213,-10.44068,7.197372E-4,0.58616,5\n622.53623,213.25,-10.44247,1.043553E-3,0.58575,5\n623.4775,213.5,-10.44029,8.124484E-4,0.58533,5\n624.39334,213.75,-10.4402,9.356938E-5,0.58493,5\n625.32809,214,-10.44134,-6.86E-04,0.58453,5\n626.2588,214.25,-10.44019,-8.67E-04,0.58412,5\n627.19511,214.5,-10.44304,-2.22E-04,0.58372,5\n628.14021,214.75,-10.44094,5.670675E-4,0.58331,5\n629.06926,215,-10.44162,5.632748E-4,0.5829,5\n630.00864,215.25,-10.43998,-2.66E-04,0.5825,5\n630.94202,215.5,-10.44234,-1.14E-03,0.5821,5\n631.85592,215.75,-10.44133,-1.56E-03,0.5817,5\n632.78283,216,-10.44137,-1.54E-03,0.5813,5\n633.69577,216.25,-10.44131,-1.21E-03,0.58091,5\n634.62705,216.5,-10.44271,-7.49E-04,0.58051,5\n635.54339,216.75,-10.44132,-4.68E-04,0.58012,5\n636.4531,217,-10.44403,-5.67E-04,0.57973,5\n637.37663,217.25,-10.44136,-9.43E-04,0.57934,5\n638.30802,217.5,-10.44369,-1.16E-03,0.57895,5\n639.24062,217.75,-10.44369,-8.28E-04,0.57855,5\n640.14905,218,-10.44505,-2.10E-04,0.57817,5\n641.07501,218.25,-10.44267,-3.03E-05,0.57777,5\n641.99677,218.5,-10.44256,-4.33E-04,0.57739,5\n642.90924,218.75,-10.44527,-8.04E-04,0.577,5\n643.82014,219,-10.44391,-6.79E-04,0.57662,5\n644.73987,219.25,-10.44456,-2.58E-04,0.57623,5\n645.64886,219.5,-10.44459,-5.37E-05,0.57585,5\n646.56264,219.75,-10.4429,-2.96E-04,0.57547,5\n647.4792,220,-10.44558,-6.74E-04,0.57509,5\n648.38622,220.25,-10.44493,-7.55E-04,0.57471,5\n649.30752,220.5,-10.44562,-5.49E-04,0.57432,5\n650.21936,220.75,-10.44381,-3.93E-04,0.57395,5\n651.13702,221,-10.44595,-3.68E-04,0.57357,5\n652.04601,221.25,-10.44566,-2.19E-04,0.57319,5\n652.9606,221.5,-10.44527,5.542460E-5,0.57281,5\n653.86203,221.75,-10.44329,9.662680E-5,0.57244,5\n654.7625,222,-10.44482,-2.00E-04,0.57207,5\n655.67763,222.25,-10.44489,-5.18E-04,0.57169,5\n656.59195,222.5,-10.44482,-6.33E-04,0.57132,5\n657.50595,222.75,-10.4455,-6.13E-04,0.57094,5\n658.40786,223,-10.4455,-5.44E-04,0.57057,5\n659.32449,223.25,-10.44649,-4.63E-04,0.5702,5\n660.22277,223.5,-10.44504,-4.07E-04,0.56983,5\n661.13202,223.75,-10.44651,-2.82E-04,0.56947,5\n662.04163,224,-10.44618,1.789506E-5,0.5691,5\n662.94413,224.25,-10.44616,2.272290E-4,0.56873,5\n663.85703,224.5,-10.44516,-6.11E-05,0.56836,5\n664.75274,224.75,-10.44516,-7.92E-04,0.568,5\n665.65884,225,-10.44718,-1.49E-03,0.56763,5\n666.56215,225.25,-10.44583,-1.73E-03,0.56727,5\n667.46927,225.5,-10.4485,-1.41E-03,0.56691,5\n668.3788,225.75,-10.44718,-9.25E-04,0.56654,5\n669.27277,226,-10.44691,-8.81E-04,0.56618,5\n670.18711,226.25,-10.44835,-1.30E-03,0.56582,5\n671.08899,226.5,-10.4482,-1.65E-03,0.56546,5\n671.99169,226.75,-10.44854,-1.54E-03,0.5651,5\n672.89721,227,-10.44998,-9.87E-04,0.56474,5\n673.80422,227.25,-10.44979,-3.16E-04,0.56438,5\n674.70424,227.5,-10.45136,8.429065E-5,0.56402,5\n675.61346,227.75,-10.44854,-3.70E-05,0.56366,5\n676.50924,228,-10.44922,-5.52E-04,0.56331,5\n677.4117,228.25,-10.44922,-9.83E-04,0.56295,5\n678.32389,228.5,-10.45024,-9.02E-04,0.5626,5\n679.21273,228.75,-10.45057,-3.29E-04,0.56225,5\n680.12224,229,-10.45058,2.540027E-4,0.56189,5\n681.01501,229.25,-10.44922,4.337396E-4,0.56154,5\n681.9223,229.5,-10.45153,2.508030E-4,0.56119,5\n682.82395,229.75,-10.45023,-1.78E-04,0.56083,5\n683.72684,230,-10.44854,-8.21E-04,0.56048,5\n684.6198,230.25,-10.45052,-1.29E-03,0.56014,5\n685.53829,230.5,-10.45114,-1.09E-03,0.55978,5\n686.42986,230.75,-10.45114,-4.94E-04,0.55943,5\n687.32571,231,-10.44977,-1.65E-04,0.55909,5\n688.23162,231.25,-10.45053,-2.94E-04,0.55874,5\n689.12922,231.5,-10.45113,-5.82E-04,0.55839,5\n690.0341,231.75,-10.44977,-7.88E-04,0.55805,5\n690.92902,232,-10.45147,-7.82E-04,0.5577,5\n691.83399,232.25,-10.45113,-5.66E-04,0.55735,5\n692.73621,232.5,-10.45102,-3.23E-04,0.55701,5\n693.63149,232.75,-10.45147,-1.50E-04,0.55667,5\n694.53748,233,-10.45147,6.331431E-5,0.55632,5\n695.4281,233.25,-10.4518,3.844229E-4,0.55598,5\n696.3301,233.5,-10.45019,6.080706E-4,0.55564,5\n697.23765,233.75,-10.44969,4.406152E-4,0.5553,5\n698.14225,234,-10.45113,-8.26E-05,0.55495,5\n699.04833,234.25,-10.45029,-5.76E-04,0.55461,5\n699.95195,234.5,-10.45248,-7.94E-04,0.55427,5\n700.85699,234.75,-10.4508,-8.12E-04,0.55393,5\n701.76476,235,-10.45183,-4.97E-04,0.55359,5\n702.66229,235.25,-10.45207,4.414908E-4,0.55325,5\n703.55677,235.5,-10.45282,1.407677E-3,0.55292,5\n704.45162,235.75,-10.44975,1.130394E-3,0.55258,5\n705.35452,236,-10.44877,-4.82E-04,0.55224,5\n706.26029,236.25,-10.45248,-1.95E-03,0.55191,5\n707.15925,236.5,-10.45181,-2.08E-03,0.55157,5\n708.06778,236.75,-10.45452,-1.10E-03,0.55123,5\n708.96531,237,-10.45331,-5.89E-05,0.5509,5\n709.8721,237.25,-10.45181,3.062774E-4,0.55057,5\n710.76501,237.5,-10.45317,9.527229E-6,0.55024,5\n711.65722,237.75,-10.45113,-4.72E-04,0.54991,5\n712.55664,238,-10.4535,-6.51E-04,0.54957,5\n713.45916,238.25,-10.45247,-3.56E-04,0.54924,5\n714.3642,238.5,-10.45335,1.409333E-4,0.54891,5\n715.2655,238.75,-10.45281,3.186798E-4,0.54858,5\n716.1734,239,-10.45254,-8.74E-05,0.54825,5\n717.07194,239.25,-10.45247,-7.65E-04,0.54792,5\n717.96991,239.5,-10.45383,-1.20E-03,0.54759,5\n718.88,239.75,-10.45271,-1.16E-03,0.54726,5\n719.77509,240,-10.45427,-6.51E-04,0.54694,5\n720.68799,240.25,-10.4544,-2.25E-07,0.5466,5\n721.58043,240.5,-10.4538,4.013475E-4,0.54628,5\n722.48275,240.75,-10.45436,5.275445E-4,0.54595,5\n723.37811,241,-10.45338,5.991788E-4,0.54563,5\n724.2758,241.25,-10.45346,5.421014E-4,0.54531,5\n725.18225,241.5,-10.45216,2.266329E-4,0.54498,5\n726.08055,241.75,-10.45368,-1.57E-04,0.54466,5\n726.98079,242,-10.45287,-5.44E-04,0.54434,5\n727.8784,242.25,-10.45341,-9.83E-04,0.54401,5\n728.77752,242.5,-10.45379,-1.21E-03,0.54369,5\n729.67512,242.75,-10.45383,-1.11E-03,0.54337,5\n730.57501,243,-10.45384,-1.01E-03,0.54305,5\n731.47263,243.25,-10.45482,-9.31E-04,0.54273,5\n732.3602,243.5,-10.45485,-6.14E-04,0.54242,5\n733.26105,243.75,-10.45483,-2.44E-04,0.5421,5\n734.17603,244,-10.45381,-2.56E-04,0.54178,5\n735.0807,244.25,-10.45484,-7.03E-04,0.54146,5\n735.97672,244.5,-10.45487,-1.35E-03,0.54114,5\n736.8801,244.75,-10.45425,-1.78E-03,0.54082,5\n737.78098,245,-10.45754,-1.37E-03,0.54051,5\n738.68148,245.25,-10.45789,-2.43E-04,0.54019,5\n739.57865,245.5,-10.45519,5.980853E-4,0.53987,5\n740.47998,245.75,-10.45417,6.951058E-4,0.53956,5\n741.38405,246,-10.45717,5.575168E-4,0.53924,5\n742.28268,246.25,-10.45586,3.636923E-4,0.53893,5\n743.19144,246.5,-10.45547,-9.61E-05,0.53861,5\n744.09343,246.75,-10.45418,-4.26E-04,0.5383,5\n744.9977,247,-10.45823,-9.68E-05,0.53799,5\n745.90139,247.25,-10.45433,4.917874E-4,0.53767,5\n746.79787,247.5,-10.45488,5.985826E-4,0.53736,5\n747.69137,247.75,-10.45418,2.311362E-4,0.53706,5\n748.59136,248,-10.45553,-1.64E-04,0.53675,5\n749.49768,248.25,-10.45475,-4.51E-04,0.53643,5\n750.40198,248.5,-10.45485,-8.13E-04,0.53612,5\n751.29334,248.75,-10.45624,-1.36E-03,0.53582,5\n752.20597,249,-10.45484,-1.84E-03,0.5355,5\n753.0997,249.25,-10.45756,-1.69E-03,0.5352,5\n753.99647,249.5,-10.45858,-8.84E-04,0.53489,5\n754.88488,249.75,-10.45581,-1.27E-04,0.53459,5\n755.78065,250,-10.45722,8.207822E-6,0.53429,5\n756.68348,250.25,-10.45722,-2.53E-04,0.53398,5\n757.59968,250.5,-10.45655,-3.66E-04,0.53367,5\n758.50198,250.75,-10.45885,-2.73E-04,0.53336,5\n759.41366,251,-10.45579,-4.45E-04,0.53305,5\n760.31299,251.25,-10.45846,-9.58E-04,0.53275,5\n761.20443,251.5,-10.45865,-1.25E-03,0.53245,5\n762.10297,251.75,-10.45745,-9.09E-04,0.53215,5\n763.00894,252,-10.45948,-1.78E-05,0.53184,5\n763.90915,252.25,-10.45963,9.062548E-4,0.53154,5\n764.80662,252.5,-10.45769,1.103161E-3,0.53124,5\n765.69738,252.75,-10.45644,4.041737E-4,0.53094,5\n766.59348,253,-10.45923,-4.14E-04,0.53064,5\n767.4939,253.25,-10.45914,-5.90E-04,0.53034,5\n768.40407,253.5,-10.45779,-2.07E-04,0.53004,5\n769.31073,253.75,-10.45936,2.086706E-4,0.52974,5\n770.20398,254,-10.4579,3.330391E-4,0.52944,5\n771.10706,254.25,-10.45803,1.735765E-4,0.52915,5\n772.01081,254.5,-10.45767,-3.29E-05,0.52885,5\n772.90501,254.75,-10.4576,-1.64E-05,0.52855,5\n773.80891,255,-10.45827,1.985794E-4,0.52825,5\n774.7136,255.25,-10.45942,2.883142E-4,0.52796,5\n775.61034,255.5,-10.45806,6.432344E-5,0.52766,5\n776.50458,255.75,-10.45517,-2.73E-04,0.52737,5\n777.41584,256,-10.45804,-4.32E-04,0.52707,5\n778.3129,256.25,-10.45802,-4.80E-04,0.52678,5\n779.22258,256.5,-10.45862,-6.55E-04,0.52648,5\n780.11401,256.75,-10.45632,-8.93E-04,0.52619,5\n781.01832,257,-10.46072,-1.03E-03,0.52589,5\n781.9161,257.25,-10.45817,-1.04E-03,0.5256,5\n782.81422,257.5,-10.45797,-6.63E-04,0.52531,5\n783.71531,257.75,-10.46178,2.497638E-4,0.52502,5\n784.61223,258,-10.45824,9.232962E-4,0.52473,5\n785.50972,258.25,-10.45854,6.046596E-4,0.52444,5\n786.41479,258.5,-10.45872,-1.82E-04,0.52415,5\n787.31569,258.75,-10.45959,-4.54E-04,0.52386,5\n788.22266,259,-10.45925,-1.75E-04,0.52356,5\n789.11906,259.25,-10.45919,-4.30E-05,0.52328,5\n790.013,259.5,-10.4579,-3.06E-04,0.52299,5\n790.92439,259.75,-10.45925,-5.28E-04,0.5227,5\n791.82334,260,-10.45993,-4.02E-04,0.52241,5\n792.72147,260.25,-10.4585,-8.05E-05,0.52212,5\n793.61746,260.5,-10.45993,2.495174E-4,0.52184,5\n794.528,260.75,-10.46021,5.020478E-4,0.52155,5\n795.43291,261,-10.45925,5.213984E-4,0.52126,5\n796.32117,261.25,-10.45768,2.653859E-4,0.52098,5\n797.23136,261.5,-10.45855,5.020462E-5,0.52069,5\n798.13267,261.75,-10.4596,1.408525E-4,0.52041,5\n799.02811,262,-10.45858,2.067043E-4,0.52012,5\n799.935,262.25,-10.45858,-1.93E-04,0.51984,5\n800.82674,262.5,-10.45825,-7.04E-04,0.51956,5\n801.7213,262.75,-10.45953,-5.59E-04,0.51927,5\n802.62409,263,-10.45891,1.673610E-4,0.51899,5\n803.53011,263.25,-10.45892,6.003549E-4,0.51871,5\n804.42578,263.5,-10.45936,3.530815E-4,0.51843,5\n805.3346,263.75,-10.4579,-1.08E-04,0.51814,5\n806.24437,264,-10.46024,-3.08E-04,0.51786,5\n807.14754,264.25,-10.45891,-2.58E-04,0.51758,5\n808.05163,264.5,-10.45993,-1.34E-04,0.51729,5\n808.94443,264.75,-10.4599,-8.27E-06,0.51702,5\n809.854,265,-10.45892,1.286399E-4,0.51673,5\n810.7425,265.25,-10.46026,3.303585E-4,0.51646,5\n811.65695,265.5,-10.45892,5.468803E-4,0.51618,5\n812.5529,265.75,-10.45824,8.013161E-4,0.5159,5\n813.44513,266,-10.4596,1.250794E-3,0.51562,5\n814.354,266.25,-10.45824,-2.58E-02,0.51534,6\n814.66498,266.5,-10.45857,-3.65E-03,0.51525,6\n814.62201,266.75,-10.45993,-1.51E-03,0.51526,6\n814.60901,267,-10.45756,-9.53E-04,0.51526,6\n814.65002,267.25,-10.46026,-6.07E-04,0.51525,6\n814.70801,267.5,-10.4579,-2.10E-04,0.51523,6\n814.77399,267.75,-10.4579,-2.18E-04,0.51521,6\n814.83099,268,-10.45925,-5.83E-04,0.5152,6\n814.88098,268.25,-10.45926,-6.41E-04,0.51518,6\n814.90997,268.5,-10.46061,-1.49E-04,0.51517,6\n814.93298,268.75,-10.45993,2.809472E-4,0.51516,6\n814.97302,269,-10.45959,1.717326E-5,0.51515,6\n814.98999,269.25,-10.45824,-7.11E-04,0.51515,6\n815.00403,269.5,-10.4596,-1.08E-03,0.51514,6\n815.01703,269.75,-10.46095,-7.22E-04,0.51514,6\n815.03497,270,-10.45959,-1.23E-04,0.51513,6\n815.04401,270.25,-10.46027,1.979745E-4,0.51513,6\n815.04999,270.5,-10.4606,1.529547E-4,0.51513,6\n815.06,270.75,-10.45993,-1.55E-04,0.51513,6\n815.06097,271,-10.46162,-6.05E-04,0.51513,6\n815.06897,271.25,-10.46027,-9.76E-04,0.51512,6\n815.06403,271.5,-10.46061,-9.22E-04,0.51512,6\n815.07001,271.75,-10.46196,-3.23E-04,0.51512,6\n815.06897,272,-10.46128,4.652711E-4,0.51512,6\n815.06702,272.25,-10.46128,8.394220E-4,0.51512,6\n815.07599,272.5,-10.46128,6.497555E-4,0.51512,6\n815.07202,272.75,-10.46129,4.291377E-4,0.51512,6\n815.07501,273,-10.45993,4.379373E-4,0.51512,6\n815.07599,273.25,-10.45993,2.996118E-4,0.51512,6\n815.06201,273.5,-10.45857,-9.72E-05,0.51512,6\n815.06598,273.75,-10.45993,-3.74E-04,0.51512,6\n815.078,274,-10.4596,-3.97E-04,0.51512,6\n815.06702,274.25,-10.4596,-3.43E-04,0.51512,6\n815.07001,274.5,-10.46095,-1.92E-04,0.51512,6\n815.07098,274.75,-10.46095,1.332911E-4,0.51512,6\n815.07001,275,-10.46129,3.231854E-4,0.51512,6\n815.07599,275.25,-10.46027,1.571560E-4,0.51512,6\n815.06403,275.5,-10.46095,6.221419E-5,0.51512,6\n815.07001,275.75,-10.46162,2.654399E-4,0.51512,6\n815.06,276,-10.4596,2.383976E-4,0.51513,6\n815.06097,276.25,-10.4596,-2.50E-04,0.51513,6\n815.06403,276.5,-10.46027,-6.74E-04,0.51512,6\n815.05902,276.75,-10.46027,-6.52E-04,0.51513,6\n815.05902,277,-10.46162,-4.22E-04,0.51513,6\n815.04901,277.25,-10.46061,-2.80E-04,0.51513,6\n815.05298,277.5,-10.46196,-1.33E-04,0.51513,6\n815.05103,277.75,-10.45993,-3.70E-05,0.51513,6\n815.05603,278,-10.46061,-1.67E-04,0.51513,6\n815.04901,278.25,-10.46027,-2.45E-04,0.51513,6\n815.05103,278.5,-10.46162,-1.72E-04,0.51513,6\n815.05499,278.75,-10.46026,-4.19E-04,0.51513,6\n815.04797,279,-10.46026,-1.11E-03,0.51513,6\n815.05701,279.25,-10.46162,-1.58E-03,0.51513,6\n815.05798,279.5,-10.46297,-1.39E-03,0.51513,6\n815.04602,279.75,-10.46162,-7.97E-04,0.51513,6\n815.04199,280,-10.4623,-1.18E-04,0.51513,6\n815.04901,280.25,-10.46162,4.485045E-4,0.51513,6\n815.04602,280.5,-10.4623,5.708027E-4,0.51513,6\n815.04901,280.75,-10.46095,1.552849E-4,0.51513,6\n815.03699,281,-10.46263,-3.29E-04,0.51513,6\n815.03699,281.25,-10.46162,-4.61E-04,0.51513,6\n815.04498,281.5,-10.46263,-3.86E-04,0.51513,6\n815.03802,281.75,-10.46196,-3.71E-04,0.51513,6\n815.04498,282,-10.46263,-4.48E-04,0.51513,6\n815.047,282.25,-10.46263,-5.53E-04,0.51513,6\n815.04901,282.5,-10.46365,-3.31E-04,0.51513,6\n815.03198,282.75,-10.46466,4.016215E-4,0.51513,6\n815.03003,283,-10.46331,7.738157E-4,0.51513,6\n815.039,283.25,-10.4623,1.319342E-4,0.51513,6\n815.039,283.5,-10.46297,-7.48E-04,0.51513,6\n815.03802,283.75,-10.46365,-9.38E-04,0.51513,6\n815.03003,284,-10.46365,-3.70E-04,0.51513,6\n815.04303,284.25,-10.46399,3.566890E-4,0.51513,6\n815.03601,284.5,-10.46264,5.335208E-4,0.51513,6\n815.03003,284.75,-10.46163,8.474254E-5,0.51513,6\n815.03998,285,-10.4623,-4.78E-04,0.51513,6\n815.04797,285.25,-10.46297,-7.84E-04,0.51513,6\n815.03699,285.5,-10.4623,-6.82E-04,0.51513,6\n815.03601,285.75,-10.4623,-8.15E-05,0.51513,6\n815.03998,286,-10.46331,7.073788E-4,0.51513,6\n815.034,286.25,-10.46298,1.134720E-3,0.51513,6\n815.03101,286.5,-10.46365,1.044079E-3,0.51513,6\n815.02899,286.75,-10.46162,5.388913E-4,0.51514,6\n815.03003,287,-10.46196,-1.33E-04,0.51513,6\n815.034,287.25,-10.46297,-4.54E-04,0.51513,6\n815.04102,287.5,-10.46229,-2.25E-04,0.51513,6\n815.034,287.75,-10.4623,1.285666E-4,0.51513,6\n815.04602,288,-10.46094,5.773011E-5,0.51513,6\n815.03601,288.25,-10.4623,-4.28E-04,0.51513,6\n815.03998,288.5,-10.46365,-7.98E-04,0.51513,6\n815.03601,288.75,-10.4623,-8.08E-04,0.51513,6\n815.02802,289,-10.46365,-6.00E-04,0.51514,6\n815.034,289.25,-10.4623,-2.51E-04,0.51513,6\n815.03198,289.5,-10.46365,9.130130E-5,0.51513,6\n815.03302,289.75,-10.4623,1.733337E-4,0.51513,6\n815.03003,290,-10.46365,-5.91E-05,0.51513,6\n815.02899,290.25,-10.46128,-4.08E-04,0.51514,6\n815.03101,290.5,-10.46365,-5.05E-04,0.51513,6\n815.03101,290.75,-10.46365,-9.61E-05,0.51513,6\n815.03302,291,-10.46297,7.146611E-4,0.51513,6\n815.03699,291.25,-10.46297,1.374543E-3,0.51513,6\n815.02502,291.5,-10.46162,1.009916E-3,0.51514,6\n815.02802,291.75,-10.46128,-3.44E-04,0.51514,6\n815.03101,292,-10.4623,-1.18E-03,0.51513,6\n815.03101,292.25,-10.46433,-5.67E-04,0.51513,6\n815.02502,292.5,-10.46264,5.257580E-4,0.51514,6\n815.03699,292.75,-10.46264,9.996558E-4,0.51513,6\n815.03601,293,-10.46229,8.578865E-4,0.51513,6\n815.03601,293.25,-10.46331,3.169135E-4,0.51513,6\n815.03998,293.5,-10.46128,-6.51E-04,0.51513,6\n815.03802,293.75,-10.46264,-1.58E-03,0.51513,6\n815.02502,294,-10.46399,-1.47E-03,0.51514,6\n815.02802,294.25,-10.465,-2.33E-04,0.51514,6\n815.02899,294.5,-10.46365,1.009698E-3,0.51514,6\n815.03699,294.75,-10.46297,1.398293E-3,0.51513,6\n815.02899,295,-10.46229,1.192560E-3,0.51514,6\n815.03802,295.25,-10.46365,7.987403E-4,0.51513,6\n815.039,295.5,-10.46196,1.632763E-4,0.51513,6\n815.04199,295.75,-10.46196,-6.25E-04,0.51513,6\n815.04199,296,-10.46264,-1.18E-03,0.51513,6\n815.04303,296.25,-10.46332,-1.24E-03,0.51513,6\n815.039,296.5,-10.46366,-8.61E-04,0.51513,6\n815.04199,296.75,-10.46298,-3.64E-04,0.51513,6\n815.039,297,-10.46365,7.252018E-5,0.51513,6\n815.04797,297.25,-10.46331,5.428166E-4,0.51513,6\n815.04797,297.5,-10.46196,8.235308E-4,0.51513,6\n815.03601,297.75,-10.4623,2.871218E-4,0.51513,6\n815.034,298,-10.46128,-9.52E-04,0.51513,6\n815.03101,298.25,-10.46433,-1.64E-03,0.51513,6\n815.02899,298.5,-10.46501,-1.00E-03,0.51514,6\n815.02002,298.75,-10.46432,1.973879E-4,0.51514,6\n815.02502,299,-10.46466,8.867983E-4,0.51514,6\n815.02399,299.25,-10.46297,7.859762E-4,0.51514,6\n815.02301,299.5,-10.46399,-3.89E-05,0.51514,6\n815.02502,299.75,-10.46263,-1.29E-03,0.51514,6\n815.01801,300,-10.46297,-1.91E-03,0.51514,6\n815.02899,300.25,-10.46569,-1.18E-03,0.51514,6\n815.03003,300.5,-10.46466,-3.93E-05,0.51513,6\n815.02502,300.75,-10.46399,2.125532E-4,0.51514,6\n815.03198,301,-10.46432,-2.88E-04,0.51513,6\n815.026,301.25,-10.46568,-6.45E-04,0.51514,6\n815.02698,301.5,-10.46467,-6.48E-04,0.51514,6\n815.02197,301.75,-10.46399,-5.63E-04,0.51514,6\n815.03601,302,-10.46399,-3.77E-04,0.51513,6\n815.02899,302.25,-10.46602,1.635384E-4,0.51514,6\n815.02698,302.5,-10.46467,8.784977E-4,0.51514,6\n815.026,302.75,-10.46433,1.078762E-3,0.51514,6\n815.021,303,-10.46365,5.904163E-4,0.51514,6\n815.02899,303.25,-10.46365,-5.16E-05,0.51514,6\n815.02899,303.5,-10.46467,-4.55E-04,0.51514,6\n815.02899,303.75,-10.46467,-6.15E-04,0.51514,6\n815.03998,304,-10.46467,-5.44E-04,0.51513,6\n815.03198,304.25,-10.46602,-2.18E-04,0.51513,6\n815.03699,304.5,-10.46467,8.697531E-5,0.51513,6\n815.03601,304.75,-10.46467,1.075696E-4,0.51513,6\n815.02802,305,-10.46433,1.138572E-4,0.51514,6\n815.03302,305.25,-10.46568,2.663940E-4,0.51513,6\n815.03998,305.5,-10.46399,2.666031E-4,0.51513,6\n815.03601,305.75,-10.46399,2.055424E-4,0.51513,6\n815.03302,306,-10.46534,3.930174E-4,0.51513,6\n815.04199,306.25,-10.46399,5.625225E-4,0.51513,6\n815.03998,306.5,-10.46466,4.707262E-4,0.51513,6\n815.03802,306.75,-10.46466,3.141058E-4,0.51513,6\n815.03802,307,-10.46332,1.251630E-4,0.51513,6\n815.03802,307.25,-10.46332,-8.26E-05,0.51513,6\n815.03998,307.5,-10.46466,2.177918E-7,0.51513,6\n815.034,307.75,-10.46433,3.151261E-4,0.51513,6\n815.02502,308,-10.46365,3.884319E-4,0.51514,6\n815.02399,308.25,-10.46365,1.708749E-4,0.51514,6\n815.03101,308.5,-10.46433,-8.09E-05,0.51513,6\n815.02899,308.75,-10.46298,-4.07E-04,0.51514,6\n815.02698,309,-10.46365,-6.61E-04,0.51514,6\n815.03302,309.25,-10.465,-3.97E-04,0.51513,6\n815.04102,309.5,-10.465,3.928223E-5,0.51513,6\n815.03101,309.75,-10.4623,-1.10E-04,0.51513,6\n815.03198,310,-10.46365,-5.66E-04,0.51513,6\n815.03198,310.25,-10.465,-6.08E-04,0.51513,6\n815.02399,310.5,-10.46298,-2.27E-04,0.51514,6\n815.03101,310.75,-10.46467,1.724427E-4,0.51513,6\n815.03198,311,-10.46433,3.030021E-4,0.51513,6\n815.03302,311.25,-10.46433,2.004259E-4,0.51513,6\n815.04303,311.5,-10.46432,-5.84E-05,0.51513,6\n815.03497,311.75,-10.46297,-6.12E-04,0.51513,6\n815.034,312,-10.46568,-1.24E-03,0.51513,6\n815.034,312.25,-10.46535,-1.37E-03,0.51513,6\n815.034,312.5,-10.465,-8.58E-04,0.51513,6\n815.034,312.75,-10.46501,5.131408E-5,0.51513,6\n815.03998,313,-10.46636,8.585105E-4,0.51513,6\n815.03497,313.25,-10.46466,8.727887E-4,0.51513,6\n815.03998,313.5,-10.46466,8.459236E-5,0.51513,6\n815.04303,313.75,-10.46432,-6.39E-04,0.51513,6\n815.03302,314,-10.465,-6.46E-04,0.51513,6\n815.03302,314.25,-10.46602,-3.32E-05,0.51513,6\n815.03198,314.5,-10.46534,5.832666E-4,0.51513,6\n815.03302,314.75,-10.46432,7.421770E-4,0.51513,6\n815.02002,315,-10.46568,6.903778E-4,0.51514,6\n815.02197,315.25,-10.46534,6.087090E-4,0.51514,6\n815.04199,315.5,-10.46365,1.829389E-4,0.51513,6\n815.03198,315.75,-10.465,-3.91E-04,0.51513,6\n815.03699,316,-10.465,-4.70E-04,0.51513,6\n815.03198,316.25,-10.46466,-1.13E-04,0.51513,6\n815.03699,316.5,-10.46466,9.943949E-5,0.51513,6\n815.04602,316.75,-10.465,-5.14E-05,0.51513,6\n815.03497,317,-10.46433,-4.82E-04,0.51513,6\n815.04498,317.25,-10.46568,-1.02E-03,0.51513,6\n815.03699,317.5,-10.465,-1.30E-03,0.51513,6\n815.04901,317.75,-10.46771,-1.05E-03,0.51513,6\n815.04797,318,-10.46635,-5.81E-04,0.51513,6\n815.02899,318.25,-10.465,-2.61E-04,0.51514,6\n815.03601,318.5,-10.46636,1.872260E-5,0.51513,6\n815.034,318.75,-10.46636,4.139669E-4,0.51513,6\n815.04401,319,-10.46568,6.858727E-4,0.51513,6\n815.04102,319.25,-10.46568,6.410798E-4,0.51513,6\n815.03601,319.5,-10.46568,3.472946E-4,0.51513,6\n815.03998,319.75,-10.46433,-1.35E-04,0.51513,6\n815.02899,320,-10.46568,-6.44E-04,0.51514,6\n815.03497,320.25,-10.46568,-9.49E-04,0.51513,6\n815.02002,320.5,-10.46635,-1.09E-03,0.51514,6\n815.03497,320.75,-10.46635,-1.13E-03,0.51513,6\n815.034,321,-10.46771,-9.31E-04,0.51513,6\n815.034,321.25,-10.46703,-5.02E-04,0.51513,6\n815.03998,321.5,-10.46771,-1.66E-04,0.51513,6\n815.034,321.75,-10.46568,-1.61E-04,0.51513,6\n815.03198,322,-10.46704,-3.62E-04,0.51513,6\n815.03497,322.25,-10.46704,-4.45E-04,0.51513,6\n815.02899,322.5,-10.46839,-3.84E-04,0.51514,6\n815.03101,322.75,-10.46704,-4.75E-04,0.51513,6\n815.03601,323,-10.4667,-6.83E-04,0.51513,6\n815.03003,323.25,-10.46783,-5.36E-04,0.51513,6\n815.03998,323.5,-10.46918,-5.63E-05,0.51513,6\n815.034,323.75,-10.46782,6.846729E-6,0.51513,6\n815.04303,324,-10.46546,-6.44E-04,0.51513,6\n815.034,324.25,-10.46783,-1.11E-03,0.51513,6\n815.03302,324.5,-10.47053,-5.31E-04,0.51513,6\n815.04498,324.75,-10.46918,4.863382E-4,0.51513,6\n815.04498,325,-10.46782,8.456577E-4,0.51513,6\n815.039,325.25,-10.46782,4.420599E-4,0.51513,6\n815.04102,325.5,-10.46782,-3.99E-05,0.51513,6\n815.03601,325.75,-10.46782,-2.81E-04,0.51513,6\n815.034,326,-10.46681,-5.54E-04,0.51513,6\n815.04102,326.25,-10.46681,-7.89E-04,0.51513,6\n815.034,326.5,-10.46918,-4.61E-04,0.51513,6\n815.03497,326.75,-10.46884,3.822894E-4,0.51513,6\n815.03497,327,-10.46816,1.024157E-3,0.51513,6\n815.03601,327.25,-10.46782,1.118206E-3,0.51513,6\n815.03497,327.5,-10.46782,9.124484E-4,0.51513,6\n815.02899,327.75,-10.46749,5.247539E-4,0.51514,6\n815.03699,328,-10.46647,2.254501E-6,0.51513,6\n815.04102,328.25,-10.46783,-3.80E-04,0.51513,6\n815.03302,328.5,-10.46918,-4.95E-04,0.51513,6\n815.04102,328.75,-10.46782,-4.01E-04,0.51513,6\n815.04199,329,-10.46816,-1.64E-04,0.51513,6\n815.03003,329.25,-10.46816,9.891798E-6,0.51513,6\n815.026,329.5,-10.46613,3.108358E-5,0.51514,6\n815.03198,329.75,-10.46884,1.940668E-4,0.51513,6\n815.02802,330,-10.46749,4.869910E-4,0.51514,6\n815.03998,330.25,-10.46749,3.642678E-4,0.51513,6\n815.02802,330.5,-10.46749,-2.44E-04,0.51514,6\n815.026,330.75,-10.46749,-6.87E-04,0.51514,6\n815.03003,331,-10.46884,-6.41E-04,0.51513,6\n815.03497,331.25,-10.46614,-4.28E-04,0.51513,6\n815.039,331.5,-10.4685,-2.16E-04,0.51513,6\n815.03601,331.75,-10.46715,4.785365E-5,0.51513,6\n815.03699,332,-10.46816,2.365041E-4,0.51513,6\n815.039,332.25,-10.46817,1.878119E-4,0.51513,6\n815.03699,332.5,-10.46816,-4.85E-05,0.51513,6\n815.03198,332.75,-10.46782,-1.77E-04,0.51513,6\n815.034,333,-10.4685,2.587155E-5,0.51513,6\n815.03699,333.25,-10.46817,2.729952E-4,0.51513,6\n815.03699,333.5,-10.46681,1.000713E-4,0.51513,6\n815.03198,333.75,-10.46749,-3.03E-04,0.51513,6\n815.04199,334,-10.46749,-3.91E-04,0.51513,6\n815.03003,334.25,-10.46918,-2.94E-04,0.51513,6\n815.03198,334.5,-10.46714,-5.08E-04,0.51513,6\n815.03302,334.75,-10.46816,-8.31E-04,0.51513,6\n815.03003,335,-10.46952,-7.93E-04,0.51513,6\n815.02802,335.25,-10.46816,-6.05E-04,0.51514,6\n815.03101,335.5,-10.46952,-6.55E-04,0.51513,6\n815.03198,335.75,-10.46816,-6.74E-04,0.51513,6\n815.034,336,-10.46985,-2.53E-04,0.51513,6\n815.02698,336.25,-10.47019,2.834438E-4,0.51514,6\n815.03101,336.5,-10.46952,3.831689E-4,0.51513,6\n815.03003,336.75,-10.46817,1.334696E-4,0.51513,6\n815.04102,337,-10.46952,-3.06E-06,0.51513,6\n815.04199,337.25,-10.46952,1.824820E-4,0.51513,6\n815.03302,337.5,-10.4685,4.347149E-4,0.51513,6\n815.03802,337.75,-10.46816,3.867820E-4,0.51513,6\n815.04401,338,-10.46918,8.036900E-5,0.51513,6\n815.04401,338.25,-10.46816,-1.04E-04,0.51513,6\n815.03802,338.5,-10.46952,4.037265E-5,0.51513,6\n815.02802,338.75,-10.4685,1.452237E-4,0.51514,6\n815.04303,339,-10.46816,-1.34E-04,0.51513,6\n815.03802,339.25,-10.46884,-3.57E-04,0.51513,6\n815.02698,339.5,-10.46884,-5.29E-05,0.51514,6\n815.03198,339.75,-10.4685,3.264894E-4,0.51513,6\n815.034,340,-10.4685,1.009444E-4,0.51513,6\n815.03003,340.25,-10.46985,-3.96E-04,0.51513,6\n815.03699,340.5,-10.46918,-3.33E-04,0.51513,6\n815.03802,340.75,-10.46986,1.941118E-4,0.51513,6\n815.03998,341,-10.46816,3.633248E-4,0.51513,6\n815.03601,341.25,-10.46884,4.285724E-5,0.51513,6\n815.04102,341.5,-10.46986,-1.80E-04,0.51513,6\n815.03497,341.75,-10.46816,-1.90E-04,0.51513,6\n815.03998,342,-10.46748,-1.33E-04,0.51513,6\n815.034,342.25,-10.4702,1.529785E-4,0.51513,6\n815.04102,342.5,-10.46748,3.975049E-4,0.51513,6\n815.034,342.75,-10.46884,2.616239E-4,0.51513,6\n815.03003,343,-10.46884,1.783087E-4,0.51513,6\n815.03101,343.25,-10.46884,3.589268E-4,0.51513,6\n815.03497,343.5,-10.46884,2.075888E-4,0.51513,6\n815.034,343.75,-10.46783,-5.90E-04,0.51513,6\n815.04199,344,-10.46884,-1.36E-03,0.51513,6\n815.04602,344.25,-10.47019,-1.29E-03,0.51513,6\n815.04303,344.5,-10.46884,-4.36E-04,0.51513,6\n815.039,344.75,-10.47019,4.263629E-4,0.51513,6\n815.034,345,-10.46952,7.435304E-4,0.51513,6\n815.034,345.25,-10.46817,6.133895E-4,0.51513,6\n815.03003,345.5,-10.4685,4.583670E-4,0.51513,6\n815.02802,345.75,-10.46952,5.393143E-4,0.51514,6\n815.026,346,-10.46782,7.730851E-4,0.51514,6\n815.034,346.25,-10.46918,8.538457E-4,0.51513,6\n815.02802,346.5,-10.4685,5.016149E-4,0.51514,6\n815.02899,346.75,-10.46715,-1.33E-04,0.51514,6\n815.02399,347,-10.46783,-5.35E-04,0.51514,6\n815.02899,347.25,-10.46884,-4.86E-04,0.51514,6\n815.03003,347.5,-10.4685,-2.48E-04,0.51513,6\n815.034,347.75,-10.4685,-7.52E-05,0.51513,6\n815.03198,348,-10.4685,3.044355E-5,0.51513,6\n815.03003,348.25,-10.46816,6.704626E-5,0.51513,6\n815.03699,348.5,-10.46816,5.956802E-5,0.51513,6\n815.039,348.75,-10.46816,1.875022E-4,0.51513,6\n815.03497,349,-10.46952,3.582062E-4,0.51513,6\n815.03998,349.25,-10.46816,2.019860E-4,0.51513,6\n815.03101,349.5,-10.46816,-1.05E-04,0.51513,6\n815.03699,349.75,-10.46884,9.932549E-9,0.51513,6\n815.034,350,-10.4685,3.093594E-4,0.51513,6\n815.03497,350.25,-10.46748,1.138014E-4,0.51513,6\n815.021,350.5,-10.4668,-4.86E-04,0.51514,6\n815.03497,350.75,-10.46952,-7.27E-04,0.51513,6\n815.03198,351,-10.4685,-3.36E-04,0.51513,6\n815.02899,351.25,-10.46917,3.969231E-4,0.51514,6\n815.03601,351.5,-10.46917,9.621532E-4,0.51513,6\n815.02899,351.75,-10.46681,9.305915E-4,0.51514,6\n815.034,352,-10.46917,5.432506E-4,0.51513,6\n815.03601,352.25,-10.46917,2.474744E-4,0.51513,6\n815.034,352.5,-10.46783,1.182943E-4,0.51513,6\n815.03699,352.75,-10.46782,1.306307E-4,0.51513,6\n815.03101,353,-10.46817,1.021886E-4,0.51513,6\n815.03497,353.25,-10.46816,-2.30E-04,0.51513,6\n815.04102,353.5,-10.46714,-7.10E-04,0.51513,6\n815.03101,353.75,-10.46816,-9.78E-04,0.51513,6\n815.02899,354,-10.46749,-9.09E-04,0.51514,6\n815.04401,354.25,-10.46918,-5.98E-04,0.51513,6\n815.04199,354.5,-10.46918,-3.23E-04,0.51513,6\n815.04199,354.75,-10.46918,-1.18E-04,0.51513,6\n815.04401,355,-10.46985,2.248762E-4,0.51513,6\n815.03302,355.25,-10.4685,4.873226E-4,0.51513,6\n815.03302,355.5,-10.46681,3.771750E-4,0.51513,6\n815.03302,355.75,-10.4685,3.218155E-4,0.51513,6\n815.03497,356,-10.4641,7.594225E-4,0.51513,6\n815.04102,356.25,-10.46703,1.156489E-3,0.51513,6\n815.04102,356.5,-10.46805,8.608820E-4,0.51513,6\n815.04102,356.75,-10.46737,1.208647E-4,0.51513,6\n815.02502,357,-10.46771,-5.61E-04,0.51514,6\n815.02502,357.25,-10.46771,-1.09E-03,0.51514,6\n815.03003,357.5,-10.46771,-1.37E-03,0.51513,6\n815.02802,357.75,-10.46805,-1.17E-03,0.51514,6\n815.03198,358,-10.46941,-7.02E-04,0.51513,6\n815.03497,358.25,-10.46839,-4.66E-04,0.51513,6\n815.04498,358.5,-10.46974,-4.25E-04,0.51513,6\n815.039,358.75,-10.46907,-2.74E-04,0.51513,6\n815.03497,359,-10.46838,-2.37E-04,0.51513,6\n815.03998,359.25,-10.46838,-5.97E-04,0.51513,6\n815.03497,359.5,-10.46974,-1.10E-03,0.51513,6\n815.03699,359.75,-10.46872,-1.14E-03,0.51513,6\n815.03497,360,-10.47008,-3.98E-04,0.51513,6\n815.02802,360.25,-10.47143,5.506231E-4,0.51514,6\n815.03601,360.5,-10.46906,6.605656E-4,0.51513,6\n815.03302,360.75,-10.46906,-1.73E-04,0.51513,6\n815.03101,361,-10.46974,-9.30E-04,0.51513,6\n815.04401,361.25,-10.47042,-7.59E-04,0.51513,6\n815.03198,361.5,-10.47109,1.820792E-4,0.51513,6\n815.03302,361.75,-10.46974,1.163691E-3,0.51513,6\n815.02802,362,-10.46974,1.626570E-3,0.51514,6\n815.04401,362.25,-10.46906,1.343941E-3,0.51513,6\n815.039,362.5,-10.46906,5.149416E-4,0.51513,6\n815.04102,362.75,-10.46873,-3.17E-04,0.51513,6\n815.034,363,-10.46974,-8.70E-04,0.51513,6\n815.03101,363.25,-10.46872,-1.05E-03,0.51513,6\n815.02698,363.5,-10.47008,-5.28E-04,0.51514,6\n815.034,363.75,-10.47143,4.867624E-4,0.51513,6\n815.04102,364,-10.46771,9.518301E-4,0.51513,6\n815.04303,364.25,-10.46805,5.145909E-4,0.51513,6\n815.04303,364.5,-10.46906,-1.89E-04,0.51513,6\n815.04602,364.75,-10.46906,-5.64E-04,0.51513,6\n815.047,365,-10.46974,-2.84E-04,0.51513,6\n815.04102,365.25,-10.47042,5.685739E-4,0.51513,6\n815.03003,365.5,-10.46906,1.205459E-3,0.51513,6\n815.03699,365.75,-10.46771,1.068709E-3,0.51513,6\n815.02502,366,-10.46906,4.993725E-4,0.51514,6\n815.03101,366.25,-10.46838,-1.11E-04,0.51513,6\n815.02502,366.5,-10.46771,-6.43E-04,0.51514,6\n815.03198,366.75,-10.46906,-9.55E-04,0.51513,6\n815.03101,367,-10.46906,-8.85E-04,0.51513,6\n815.02802,367.25,-10.47042,-3.62E-04,0.51514,6\n815.03003,367.5,-10.46907,2.404655E-4,0.51513,6\n815.034,367.75,-10.46805,4.061441E-4,0.51513,6\n815.02399,368,-10.4694,1.521193E-4,0.51514,6\n815.02502,368.25,-10.46839,-1.86E-04,0.51514,6\n815.01898,368.5,-10.46872,-3.69E-04,0.51514,6\n815.03302,368.75,-10.47008,-4.05E-04,0.51513,6\n815.03101,369,-10.46872,-4.46E-04,0.51513,6\n815.03802,369.25,-10.47143,-5.01E-04,0.51513,6\n815.04901,369.5,-10.47007,-4.70E-04,0.51513,6\n815.03998,369.75,-10.46906,-2.05E-04,0.51513,6\n815.04102,370,-10.47042,3.401891E-4,0.51513,6\n815.03802,370.25,-10.47042,7.530063E-4,0.51513,6\n815.034,370.5,-10.46974,5.593702E-4,0.51513,6\n815.02899,370.75,-10.46873,-3.78E-05,0.51514,6\n815.03101,371,-10.4694,-4.24E-04,0.51513,6\n815.03497,371.25,-10.46872,-2.98E-04,0.51513,6\n815.039,371.5,-10.47075,1.673594E-4,0.51513,6\n815.03198,371.75,-10.4694,3.928315E-4,0.51513,6\n815.03699,372,-10.46906,1.261800E-4,0.51513,6\n815.03601,372.25,-10.46906,1.916254E-4,0.51513,6\n815.034,372.5,-10.47109,1.058966E-3,0.51513,6\n815.03101,372.75,-10.46771,1.446738E-3,0.51513,6\n815.03198,373,-10.46771,2.371436E-4,0.51513,6\n815.03198,373.25,-10.46907,-1.56E-03,0.51513,6\n815.039,373.5,-10.47008,-2.36E-03,0.51513,6\n815.039,373.75,-10.47008,-1.69E-03,0.51513,6\n815.03198,374,-10.47144,9.096792E-6,0.51513,6\n815.034,374.25,-10.47008,1.385096E-3,0.51513,6\n815.04401,374.5,-10.46907,1.202211E-3,0.51513,6\n815.04602,374.75,-10.46906,-5.61E-05,0.51513,6\n815.03497,375,-10.47008,-1.12E-03,0.51513,6\n815.039,375.25,-10.46873,-1.55E-03,0.51513,6\n815.03302,375.5,-10.47042,-1.42E-03,0.51513,6\n815.03699,375.75,-10.47177,-8.73E-04,0.51513,6\n815.03003,376,-10.47042,-2.31E-04,0.51513,6\n815.03101,376.25,-10.47177,1.962068E-4,0.51513,6\n815.02197,376.5,-10.46974,1.220628E-4,0.51514,6\n815.021,376.75,-10.47076,-2.66E-04,0.51514,6\n815.03302,377,-10.47076,-2.25E-04,0.51513,6\n815.04102,377.25,-10.47143,1.628468E-4,0.51513,6\n815.03699,377.5,-10.47008,-2.27E-05,0.51513,6\n815.03101,377.75,-10.47109,-6.23E-04,0.51513,6\n815.02698,378,-10.47007,-3.47E-04,0.51514,6\n815.03198,378.25,-10.47245,8.294214E-4,0.51513,6\n815.039,378.5,-10.47042,1.183703E-3,0.51513,6\n815.03198,378.75,-10.4694,8.051463E-5,0.51513,6\n815.03998,379,-10.47076,-1.00E-03,0.51513,6\n815.04602,379.25,-10.47109,-1.06E-03,0.51513,6\n815.03802,379.5,-10.47075,-6.19E-04,0.51513,6\n815.03497,379.75,-10.4721,-2.94E-04,0.51513,6\n815.02698,380,-10.47042,-2.72E-04,0.51514,6\n815.03302,380.25,-10.47042,-4.63E-04,0.51513,6\n815.03699,380.5,-10.47143,-3.92E-04,0.51513,6\n815.03198,380.75,-10.4721,1.831957E-5,0.51513,6\n815.03101,381,-10.47041,1.745098E-4,0.51513,6\n815.03497,381.25,-10.4711,-3.46E-05,0.51513,6\n815.03101,381.5,-10.4721,-1.77E-04,0.51513,6\n815.034,381.75,-10.47109,-2.89E-04,0.51513,6\n815.03699,382,-10.47109,-5.37E-04,0.51513,6\n815.03497,382.25,-10.47211,-6.56E-04,0.51513,6\n815.03003,382.5,-10.47076,-4.84E-04,0.51513,6\n815.02802,382.75,-10.47244,-2.07E-04,0.51514,6\n815.02502,383,-10.47098,-2.98E-05,0.51514,6\n815.03003,383.25,-10.47165,6.940756E-5,0.51513,6\n815.03601,383.5,-10.47166,1.377787E-4,0.51513,6\n815.03497,383.75,-10.47166,-2.95E-05,0.51513,6\n815.04303,384,-10.47234,-2.84E-04,0.51513,6\n815.04102,384.25,-10.47369,-4.03E-05,0.51513,6\n815.03302,384.5,-10.47233,5.550489E-4,0.51513,6\n815.04199,384.75,-10.47132,7.534939E-4,0.51513,6\n815.03998,385,-10.47165,5.326112E-4,0.51513,6\n815.039,385.25,-10.472,3.897237E-4,0.51513,6\n815.03699,385.5,-10.47099,5.359958E-4,0.51513,6\n815.03998,385.75,-10.47199,1.299215E-3,0.51513,6","type":"text"},{"name":"mixchar-gui.Rproj","content":"Version: 1.0\n\nRestoreWorkspace: No\nSaveWorkspace: No\nAlwaysSaveHistory: Default\n\nEnableCodeIndexing: Yes\nUseSpacesForTab: Yes\nNumSpacesForTab: 2\nEncoding: UTF-8\n\nRnwWeave: Sweave\nLaTeX: pdfLaTeX\n","type":"text"},{"name":"sankey.R","content":"# ============================================================================\n# sankey.R - Sankey Diagram Visualization for Carbon Fractions\n# ============================================================================\n#\n# Purpose:\n#   Creates interactive Sankey diagrams to visualize carbon fraction flows\n#   from total biomass through components (moisture, ash, hemicellulose,\n#   cellulose, lignin) to their volatile and fixed carbon sub-components.\n#\n# Architecture:\n#   - Three-column layout: source (left), totals (middle), vol/fc (right)\n#   - Left: Total Biomass (100%)\n#   - Middle: Moisture, Ash, Hemicellulose/Cellulose/Lignin totals\n#   - Right: Volatile and Fixed Carbon for each component\n#\n# Dependencies:\n#   - plotly package for interactive visualization\n#\n# Usage:\n#   Called from server.R via render_fractions_sankey() when user selects\n#   Sankey diagram view in the fractions step.\n#\n# Modification Notes:\n#   - Node positions (node_x, node_y) control layout - adjust for different arrangements\n#   - Colors are defined per component type (hemi, cell, lig, moisture, ash)\n#   - Link sources/targets use 0-based indexing matching node order\n#   - To add new components, update node_labels, node positions, and link arrays\n#\n# ============================================================================\n\nlibrary(plotly)\n\n# ----------------------------------------------------------------------------\n# Label Generation\n# ----------------------------------------------------------------------------\n\n#' Build node labels with inline percentages for Sankey diagram\n#'\n#' Creates formatted labels for all nodes showing component names and their\n#' percentage values. Labels are displayed on the Sankey nodes.\n#'\n#' @param vals Named list containing fraction values:\n#'   - moisture, ash (direct percentages)\n#'   - total_H, total_C, total_L (hemicellulose, cellulose, lignin totals)\n#'   - vol_H, vol_C, vol_L (volatile fractions)\n#'   - fc_H, fc_C, fc_L (fixed carbon fractions)\n#' @return Character vector of 12 formatted labels (one per node)\nbuild_sankey_labels <- function(vals) {\n  c(\n    \"Total Biomass (100%)\",\n    sprintf(\"Moisture (%.2f%%)\", vals$moisture),\n    sprintf(\"Hemicellulose total (%.2f%%)\", vals$total_H),\n    sprintf(\"Cellulose total (%.2f%%)\", vals$total_C),\n    sprintf(\"Lignin total (%.2f%%)\", vals$total_L),\n    sprintf(\"Ash (%.2f%%)\", vals$ash),\n    sprintf(\"Hemi. Volatile (%.2f%%)\", vals$vol_H),\n    sprintf(\"Hemi. Fixed Carbon (%.2f%%)\", vals$fc_H),\n    sprintf(\"Cell. Volatile (%.2f%%)\", vals$vol_C),\n    sprintf(\"Cell. Fixed Carbon (%.2f%%)\", vals$fc_C),\n    sprintf(\"Lignin Volatile (%.2f%%)\", vals$vol_L),\n    sprintf(\"Lignin Fixed Carbon (%.2f%%)\", vals$fc_L)\n  )\n}\n\n# ----------------------------------------------------------------------------\n# Sankey Diagram Rendering\n# ----------------------------------------------------------------------------\n\n#' Render interactive Sankey diagram for carbon fractions\n#'\n#' Creates a plotly Sankey diagram visualizing the flow of carbon fractions\n#' from total biomass through components to volatile and fixed carbon sub-components.\n#'\n#' @param vals Named list of fraction values (see build_sankey_labels for structure)\n#' @return plotly object (Sankey diagram)\n#' @note Requires all values to be non-NA. Called from server.R when user\n#'       enables Sankey view in the fractions step.\nrender_fractions_sankey <- function(vals) {\n  # Validate that all required values are present\n  all_vals <- unlist(vals, use.names = FALSE)\n  if (any(is.na(all_vals))) {\n    stop(\"Carbon fraction values missing; unable to build Sankey.\")\n  }\n\n  node_labels <- build_sankey_labels(vals)\n\n  # --------------------------------------------------------------------------\n  # Node Layout Configuration\n  # --------------------------------------------------------------------------\n  # Three-column layout: source (left), totals (middle), vol/fc (right)\n  # Node indices: 0=Total Biomass, 1=Moisture, 2=Hemi total, 3=Cell total,\n  #               4=Lignin total, 5=Ash, 6-7=Hemi vol/fc, 8-9=Cell vol/fc,\n  #               10-11=Lignin vol/fc\n  node_x <- c(0, rep(0.48, 5), rep(0.94, 6))\n  node_y <- c(\n    0.50,  # Total Biomass (left)\n    0.05,  # Moisture (top)\n    0.25,  # Hemi total\n    0.45,  # Cell total\n    0.65,  # Lignin total\n    0.92,  # Ash (bottom)\n    0.22, 0.30,  # Hemi volatile / fixed carbon near Hemi total\n    0.42, 0.58,  # Cell volatile / fixed carbonnear Hemi total\n    0.62, 0.70   # Lignin volatile / fixed carbon near Lignin total\n  )\n\n  # --------------------------------------------------------------------------\n  # Color Scheme\n  # --------------------------------------------------------------------------\n  # Component-specific colors for visual consistency across nodes and links\n  col_hemi <- \"#14b8a6\"    # Teal for hemicellulose\n  col_cell <- \"#22c55e\"    # Green for cellulose\n  col_lig <- \"#f59e0b\"     # Orange for lignin\n  col_moist <- \"#0ea5e9\"   # Blue for moisture\n  col_ash <- \"#475569\"     # Gray for ash\n\n  # Node colors matching component types\n  # Order: Total Biomass, Moisture, Hemi, Cell, Lignin, Ash, then vol/fc pairs\n  node_colors <- c(\n    \"#0f172a\",\n    col_moist,\n    col_hemi,\n    col_cell,\n    col_lig,\n    col_ash,\n    col_hemi, col_hemi,\n    col_cell, col_cell,\n    col_lig, col_lig\n  )\n\n  # --------------------------------------------------------------------------\n  # Link Configuration (Flow Connections)\n  # --------------------------------------------------------------------------\n  # Links define the flow paths between nodes\n  # Format: source node index -> target node index with flow value\n  # Links from Total Biomass (0) to: Moisture(1), Ash(5), Hemi(2), Cell(3), Lignin(4)\n  # Links from totals to vol/fc: Hemi(2)->vol(6)/fc(7), Cell(3)->vol(8)/fc(9), Lignin(4)->vol(10)/fc(11)\n  link_sources <- c(0, 0, 0, 0, 0, 2, 2, 3, 3, 4, 4)\n  link_targets <- c(1, 5, 2, 3, 4, 6, 7, 8, 9, 10, 11)\n  link_values <- c(\n    vals$moisture, vals$ash,\n    vals$total_H, vals$total_C, vals$total_L,\n    vals$vol_H, vals$fc_H,\n    vals$vol_C, vals$fc_C,\n    vals$vol_L, vals$fc_L\n  )\n  link_colors <- c(\n    col_moist, col_ash,\n    col_hemi, col_cell, col_lig,\n    col_hemi, col_hemi,\n    col_cell, col_cell,\n    col_lig, col_lig\n  )\n\n  # --------------------------------------------------------------------------\n  # Create Plotly Sankey Diagram\n  # --------------------------------------------------------------------------\n  plot_ly(\n    type = \"sankey\",\n    arrangement = \"fixed\",\n    node = list(\n      label = node_labels,\n      x = node_x,\n      y = node_y,\n      color = node_colors,\n      pad = 14,\n      line = list(color = \"rgba(15, 23, 42, 0.3)\", width = 1)\n    ),\n    link = list(\n      source = link_sources,\n      target = link_targets,\n      value = round(link_values, 3),\n      color = link_colors,\n      hovertemplate = \"%{source.label} -> %{target.label}: %{value:.2f}%<extra><\/extra>\"\n    )\n  ) |>\n    layout(\n      margin = list(l = 20, r = 80, t = 10, b = 10),\n      font = list(family = \"Barlow, sans-serif\", size = 14, color = \"#0f172a\")\n    )\n}\n","type":"text"}]
